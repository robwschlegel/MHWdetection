<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Robert W Schlegel" />

<meta name="date" content="2019-05-06" />

<title>Arguments for MHW outputs in R and Python</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">MHW detection</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Overview</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="r_vs_python.html">Python vs. R - default outputs</a>
    </li>
    <li>
      <a href="r_vs_python_arguments.html">Python vs. R - default arguments</a>
    </li>
    <li>
      <a href="r_vs_python_additional.html">Python vs. R - additional functions</a>
    </li>
    <li>
      <a href="time_series_duration.html">Effects of short time series</a>
    </li>
    <li>
      <a href="missing_data.html">Effects of missing data</a>
    </li>
    <li>
      <a href="trend.html">Effects of long-term trends</a>
    </li>
    <li>
      <a href="best_practices.html">Best practices</a>
    </li>
  </ul>
</li>
<li>
  <a href="portrait.pdf">Poster</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
<li>
  <a href="news.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/robwschlegel/MHWdetection">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Arguments for MHW outputs in R and Python</h1>
<h4 class="author"><em>Robert W Schlegel</em></h4>
<h4 class="date"><em>2019-05-06</em></h4>

</div>


<p><strong>Last updated:</strong> 2019-05-06</p>
<strong>workflowr checks:</strong> <small>(Click a bullet for more information)</small>
<ul>
<li>
<details>
<p><summary> <strong style="color:red;">✖</strong> <strong>R Markdown file:</strong> uncommitted changes </summary> The R Markdown file has unstaged changes. To know which version of the R Markdown file created these results, you’ll want to first commit it to the Git repo. If you’re still working on the analysis, you can ignore this warning. When you’re finished, you can run <code>wflow_publish</code> to commit the R Markdown file and build the HTML.</p>
</details>
</li>
<li>
<details>
<p><summary> <strong style="color:blue;">✔</strong> <strong>Environment:</strong> empty </summary></p>
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</details>
</li>
<li>
<details>
<p><summary> <strong style="color:blue;">✔</strong> <strong>Seed:</strong> <code>set.seed(666)</code> </summary></p>
<p>The command <code>set.seed(666)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</details>
</li>
<li>
<details>
<p><summary> <strong style="color:blue;">✔</strong> <strong>Session information:</strong> recorded </summary></p>
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</details>
</li>
<li>
<details>
<p><summary> <strong style="color:blue;">✔</strong> <strong>Repository version:</strong> <a href="https://github.com/robwschlegel/MHWdetection/tree/b1a7e3fcf3dacdd2ba4d7cd79a44fef13dd6191f" target="_blank">b1a7e3f</a> </summary></p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility. The version displayed above was the version of the Git repository at the time these results were generated. <br><br> Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    data/global/
    Ignored:    data/global_KS_cat.Rdata
    Ignored:    data/global_KS_clim.Rdata
    Ignored:    data/global_KS_event.Rdata
    Ignored:    data/global_dec_trend.Rdata
    Ignored:    data/global_effect_cat.Rdata
    Ignored:    data/global_effect_clim.Rdata
    Ignored:    data/global_effect_event.Rdata
    Ignored:    data/global_effect_event_length_slope.Rdata
    Ignored:    data/global_effect_event_slope.Rdata
    Ignored:    data/sst_ALL_add_trend.Rdata
    Ignored:    data/sst_ALL_aov_tukey.Rdata
    Ignored:    data/sst_ALL_clim_event_cat.Rdata
    Ignored:    data/sst_ALL_clim_event_cat_fix.Rdata
    Ignored:    data/sst_ALL_flat.Rdata
    Ignored:    data/sst_ALL_knockout.Rdata
    Ignored:    data/sst_ALL_length.Rdata
    Ignored:    data/sst_ALL_length_width_10.Rdata
    Ignored:    data/sst_ALL_length_width_20.Rdata
    Ignored:    data/sst_ALL_length_width_30.Rdata
    Ignored:    data/sst_ALL_length_width_40.Rdata
    Ignored:    data/sst_ALL_length_width_50.Rdata
    Ignored:    data/sst_ALL_missing.Rdata
    Ignored:    data/sst_ALL_missing_fix.Rdata
    Ignored:    data/sst_ALL_repl.Rdata
    Ignored:    data/sst_ALL_trended.Rdata

Unstaged changes:
    Modified:   analysis/Climatologies_and_baselines.Rmd
    Modified:   analysis/best_practices.Rmd
    Modified:   analysis/r_vs_python.Rmd
    Modified:   analysis/r_vs_python_arguments.Rmd

</code></pre>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</details>
</li>
</ul>
<details>
<summary> <small><strong>Expand here to see past versions:</strong></small> </summary>
<ul>
<table style="border-collapse:separate; border-spacing:5px;">
<thead>
<tr>
<th style="text-align:left;">
File
</th>
<th style="text-align:left;">
Version
</th>
<th style="text-align:left;">
Author
</th>
<th style="text-align:left;">
Date
</th>
<th style="text-align:left;">
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
html
</td>
<td style="text-align:left;">
<a href="https://cdn.rawgit.com/robwschlegel/MHWdetection/38559da0810a23b9416a3df8d57aa1c1ab651204/docs/r_vs_python_arguments.html" target="_blank">38559da</a>
</td>
<td style="text-align:left;">
robwschlegel
</td>
<td style="text-align:left;">
2019-03-19
</td>
<td style="text-align:left;">
Build site.
</td>
</tr>
<tr>
<td style="text-align:left;">
Rmd
</td>
<td style="text-align:left;">
<a href="https://github.com/robwschlegel/MHWdetection/blob/970b22c7c2cae4e09824722f8bf1d87fb5118a73/analysis/r_vs_python_arguments.Rmd" target="_blank">970b22c</a>
</td>
<td style="text-align:left;">
robwschlegel
</td>
<td style="text-align:left;">
2019-03-19
</td>
<td style="text-align:left;">
Publish the vignettes from when this was a pkgdown framework
</td>
</tr>
<tr>
<td style="text-align:left;">
html
</td>
<td style="text-align:left;">
<a href="https://cdn.rawgit.com/robwschlegel/MHWdetection/fa7fd57d97caa42308afbb27f761077d74e5239e/docs/r_vs_python_arguments.html" target="_blank">fa7fd57</a>
</td>
<td style="text-align:left;">
robwschlegel
</td>
<td style="text-align:left;">
2019-03-19
</td>
<td style="text-align:left;">
Build site.
</td>
</tr>
<tr>
<td style="text-align:left;">
Rmd
</td>
<td style="text-align:left;">
<a href="https://github.com/robwschlegel/MHWdetection/blob/64ac134076a04088c834291ce86c6405eedaf672/analysis/r_vs_python_arguments.Rmd" target="_blank">64ac134</a>
</td>
<td style="text-align:left;">
robwschlegel
</td>
<td style="text-align:left;">
2019-03-19
</td>
<td style="text-align:left;">
Publish analysis files
</td>
</tr>
</tbody>
</table>
</ul>
</details>
<hr />
<div id="overview" class="section level2">
<h2>Overview</h2>
<p>Building on the default functionality shared between the two languages, this vignette goes further to look at how changing the default arguments may affect the results. Along the way the outputs are checked for consistency and all of the arguments for all of the functions are tweaked to look for irregularities. This is necessary before only one language is used to further investigate best practices for dealing with sub-optimal time series in the detection of MHWs.</p>
<p>Preferably this step could have been done programmatically, without creating an army of outputs as seen below. The R package <strong><code>reticulate</code></strong> does not seem to want to play along though so I must rather run the Python code, save the outputs, load them into R and compare the results natively in just R… So let’s get started.</p>
<pre class="r"><code>library(tidyverse)
library(ggpubr)
library(heatwaveR)</code></pre>
<pre class="r"><code>library(reticulate)
use_condaenv(&quot;py27&quot;)</code></pre>
<pre class="python"><code>import numpy as np
from datetime import date
import pandas as pd
import marineHeatWaves as mhw
# The date values
t = np.arange(date(1982,1,1).toordinal(),date(2014,12,31).toordinal()+1)
# The temperature values
sst = np.loadtxt(open(&quot;data/sst_WA.csv&quot;, &quot;r&quot;), delimiter = &#39;,&#39;, skiprows = 1)</code></pre>
<pre class="r"><code># The default python output from the previous comparison vignette
default_py_event &lt;- read_csv(&quot;data/mhws_py.csv&quot;)
default_py_clim &lt;- read_csv(&quot;data/clim_py.csv&quot;)</code></pre>
<pre class="r"><code># The default R output
default_r &lt;- detect_event(ts2clm(data = sst_WA,
                                 climatologyPeriod = c(&quot;1982-01-01&quot;, &quot;2014-12-31&quot;)))</code></pre>
<pre class="r"><code>compare_event &lt;- function(res_event_R, res_event_Python){
  # Remove non-numeric columns
  res_event_num &lt;- res_event_R %&gt;% 
    select_if(is.numeric)
  # Run the loop
  res_event_cor &lt;- data.frame()
  for(i in 1:length(colnames(res_event_num))){
    if(colnames(res_event_num)[i] %in% colnames(res_event_Python)){
      x1 &lt;- res_event_R[colnames(res_event_R) == colnames(res_event_num)[i]]
      x2 &lt;- res_event_Python[colnames(res_event_Python) == colnames(res_event_num)[i]]
      x &lt;- data.frame(r = cor(x1, x2), var = colnames(res_event_num)[i])
      colnames(x)[1] &lt;- &quot;r&quot;
      rownames(x) &lt;- NULL
      } else {
        x &lt;- data.frame(r = NA, var = colnames(res_event_num)[i])
        }
    res_event_cor &lt;- rbind(res_event_cor, x)
    }
  return(res_event_cor)
  }</code></pre>
<pre class="r"><code># Compare default clims and intensities
cor(default_r$climatology$seas, default_py_clim$seas)
sum(default_r$climatology$seas) - sum(default_py_clim$seas)
cor(default_r$climatology$thresh, default_py_clim$thresh)
sum(default_r$climatology$thresh) - sum(default_py_clim$thresh)
sum(default_r$event$intensity_cumulative) - sum(default_py_event$intensity_cumulative)
sum(default_r$event$intensity_max) - sum(default_py_event$intensity_max)

# Compare default events
default_event &lt;- compare_event(default_r$event, default_py_event)
default_event</code></pre>
</div>
<div id="pctile-comparisons" class="section level2">
<h2><code>pctile</code> comparisons</h2>
<p>Here we look at a few possible settings for the <code>pctile</code> argument and ensure that everything matches up.</p>
<p>First run and save the Python output.</p>
<pre class="python"><code># pctile = 80
mhws, clim = mhw.detect(t, sst, pctile = 80)
mhws_df = pd.DataFrame.from_dict(mhws)
mhws_df.to_csv(&#39;data/mhws_py_pctile_80.csv&#39;, sep = &#39;,&#39;, index = False)
clim_df = pd.DataFrame.from_dict(clim)
clim_df.to_csv(&#39;data/clim_py_pctile_80.csv&#39;, sep = &#39;,&#39;, index = False)
# pctile = 95
mhws, clim = mhw.detect(t, sst, pctile = 95)
mhws_df = pd.DataFrame.from_dict(mhws)
mhws_df.to_csv(&#39;data/mhws_py_pctile_95.csv&#39;, sep = &#39;,&#39;, index = False)
clim_df = pd.DataFrame.from_dict(clim)
clim_df.to_csv(&#39;data/clim_py_pctile_95.csv&#39;, sep = &#39;,&#39;, index = False)
# pctile = 99
mhws, clim = mhw.detect(t, sst, pctile = 99)
mhws_df = pd.DataFrame.from_dict(mhws)
mhws_df.to_csv(&#39;data/mhws_py_pctile_99.csv&#39;, sep = &#39;,&#39;, index = False)
clim_df = pd.DataFrame.from_dict(clim)
clim_df.to_csv(&#39;data/clim_py_pctile_99.csv&#39;, sep = &#39;,&#39;, index = False)</code></pre>
<p>Then run the R output.</p>
<pre class="r"><code>pctile_80_r &lt;- detect_event(ts2clm(data = sst_WA, pctile = 80,
                                   climatologyPeriod = c(&quot;1982-01-01&quot;, &quot;2014-12-31&quot;)))
pctile_95_r &lt;- detect_event(ts2clm(data = sst_WA, pctile = 95,
                                   climatologyPeriod = c(&quot;1982-01-01&quot;, &quot;2014-12-31&quot;)))
pctile_99_r &lt;- detect_event(ts2clm(data = sst_WA, pctile = 99,
                                   climatologyPeriod = c(&quot;1982-01-01&quot;, &quot;2014-12-31&quot;)))</code></pre>
<p>Lastly load the Python output and compare the two.</p>
<pre class="r"><code># Load Python
pctile_80_py_event &lt;- read_csv(&quot;data/mhws_py_pctile_80.csv&quot;)
pctile_80_py_clim &lt;- read_csv(&quot;data/clim_py_pctile_80.csv&quot;)
pctile_95_py_event &lt;- read_csv(&quot;data/mhws_py_pctile_95.csv&quot;)
pctile_95_py_clim &lt;- read_csv(&quot;data/clim_py_pctile_95.csv&quot;)
pctile_99_py_event &lt;- read_csv(&quot;data/mhws_py_pctile_99.csv&quot;)
pctile_99_py_clim &lt;- read_csv(&quot;data/clim_py_pctile_99.csv&quot;)

# Compare clims and intensities
# 80
cor(pctile_80_r$climatology$seas, pctile_80_py_clim$seas)
sum(pctile_80_r$climatology$seas) - sum(pctile_80_py_clim$seas)
cor(pctile_80_r$climatology$thresh, pctile_80_py_clim$thresh)
sum(pctile_80_r$climatology$thresh) - sum(pctile_80_py_clim$thresh)
sum(pctile_80_r$event$intensity_cumulative) - sum(pctile_80_py_event$intensity_cumulative)
sum(pctile_80_r$event$intensity_max) - sum(pctile_80_py_event$intensity_max)
# 95
cor(pctile_95_r$climatology$seas, pctile_95_py_clim$seas)
sum(pctile_95_r$climatology$seas) - sum(pctile_95_py_clim$seas)
cor(pctile_95_r$climatology$thresh, pctile_95_py_clim$thresh)
sum(pctile_95_r$climatology$thresh) - sum(pctile_95_py_clim$thresh)
sum(pctile_95_r$event$intensity_cumulative) - sum(pctile_95_py_event$intensity_cumulative)
sum(pctile_95_r$event$intensity_max) - sum(pctile_95_py_event$intensity_max)
# 99
cor(pctile_99_r$climatology$seas, pctile_99_py_clim$seas)
sum(pctile_99_r$climatology$seas) - sum(pctile_99_py_clim$seas)
cor(pctile_99_r$climatology$thresh, pctile_99_py_clim$thresh)
sum(pctile_99_r$climatology$thresh) - sum(pctile_99_py_clim$thresh)
sum(pctile_99_r$event$intensity_cumulative) - sum(pctile_99_py_event$intensity_cumulative)
sum(pctile_99_r$event$intensity_max) - sum(pctile_99_py_event$intensity_max)

# Compare events
# pctile_80_event &lt;- compare_event(pctile_80_r$event, pctile_80_py_event)
pctile_95_event &lt;- compare_event(pctile_95_r$event, pctile_95_py_event)
pctile_95_event
pctile_99_event &lt;- compare_event(pctile_99_r$event, pctile_99_py_event)
pctile_99_event</code></pre>
<p>There appears to be an issue with the results when the threshold is set to <code>pctile = 80</code> as Python detects one more event than R. Let’s take a closer look.</p>
<pre class="r"><code>pctile_80_r_event &lt;- pctile_80_r$event
pctile_80_py_event$date_start[!pctile_80_py_event$date_start %in% pctile_80_r_event$date_start]</code></pre>
<p>The issue appears to be that the R code is joining across a four day gap, which it shouldn’t do. So I assume that the threshold is different between the languages. This is curious as the seasonal and threshold climatologies correlate nearly perfectly. Diving deeper, let’s pull out the clim values around the time of this event and see what we see.</p>
<pre class="r"><code>pctile_80_r_clim &lt;- pctile_80_r$climatology
pctile_80_r_clim_sub &lt;- pctile_80_r_clim[11670:11720, ]
pctile_80_py_clim_sub &lt;- pctile_80_py_clim[11670:11720, ]

r_fig &lt;- ggplot(pctile_80_r_clim_sub, aes(x = t, y = temp)) +
  geom_flame(aes(y2 = thresh)) +
  geom_line() +
  geom_line(aes(y = thresh), colour = &quot;Red&quot;) +
  geom_line(aes(y = seas), colour = &quot;grey20&quot;) +
  ggtitle(&quot;R code&quot;)

py_fig &lt;- ggplot(pctile_80_py_clim_sub, 
                 aes(x = pctile_80_r_clim_sub$t, y = pctile_80_r_clim_sub$temp)) +
  geom_flame(aes(y2 = thresh)) +
  geom_line() +
  geom_line(aes(y = thresh), colour = &quot;Red&quot;) +
  geom_line(aes(y = seas), colour = &quot;grey20&quot;) +
  ggtitle(&quot;Python code&quot;)

ggarrange(r_fig, py_fig, ncol = 1, nrow = 2)</code></pre>
<p>As we may see in the figure above, the difference is not perceptible to the human eye. Looking very closely at the clim outputs manually one may see that in the R code, the threshold on <code>2013-12-29</code> is just below the temperature value due to a rounding difference from the Python code at the third decimal place.</p>
<p>Also above one may see that even though the values correlate nearly perfectly, the sum of the seasonal climatology value output by R are <code>1.98122</code> less than the Python output. Considering that there are 12053 values, the average difference is only <code>0.00016</code>, which is not terribly much at all. The issue appears to be in the calculation of the threshold climatology. This value is not consistently different based on the <code>pctile</code> value used. It varies quite a bit. With the sum difference at <code>pctile = 80</code> being <code>-13.86432</code>, the default of <code>pctile = 90</code> being <code>-6.563516</code>, <code>pctile = 95</code> being <code>-3.382435</code>, and <code>pctile = 99</code> being <code>28.37769</code>. This is strong evidence that the threshold values are being calculated using some different method that needs to be addressed. That being said, even at the largest difference of <code>28.37769</code>, that is still only an average difference per row of <code>0.002354409</code></p>
<p>Digging deeper still, let’s pull up the old <code>RmarineHeatWaves</code> code and run another comparison with that to see if this difference is due to newer changes in the development of the <code>heatwaveR</code> package.</p>
<pre class="r"><code>ts &lt;- RmarineHeatWaves::make_whole(sst_WA)
default_r_old &lt;- RmarineHeatWaves::detect(data = ts, climatology_start = &quot;1982-01-01&quot;, climatology_end = &quot;2014-12-31&quot;)
default_r_old_event &lt;- default_r_old$event
default_r_old_clim &lt;- default_r_old$clim

# Compare default new and old R clims  and intensities
cor(default_r$climatology$seas, default_r_old_clim$seas_clim_year)
sum(default_r$climatology$seas) - sum(default_r_old_clim$seas_clim_year)
cor(default_r$climatology$thresh, default_r_old_clim$thresh_clim_year)
sum(default_r$climatology$thresh) - sum(default_r_old_clim$thresh_clim_year)
sum(default_r$event$intensity_cumulative) - sum(default_py_event$intensity_cumulative)
sum(default_r$event$intensity_max) - sum(default_py_event$intensity_max)

# Compare default new and old R clims
default_event &lt;- compare_event(default_r$event, default_r_old_event)
default_event

# Compare Python and old R clims and intensities
cor(default_py_clim$seas, default_r_old_clim$seas_clim_year)
sum(default_py_clim$seas) - sum(default_r_old_clim$seas_clim_year)
cor(default_py_clim$thresh, default_r_old_clim$thresh_clim_year)
sum(default_py_clim$thresh) - sum(default_r_old_clim$thresh_clim_year)
sum(default_py_event$intensity_cumulative) - sum(default_r_old_event$int_cum)
sum(default_py_event$intensity_max) - sum(default_r_old_event$int_max)

# Compare Python and old R clims
default_event &lt;- compare_event(default_r_old_event, default_py_event)
default_event</code></pre>
<p>The differences between the old and new R implementation are minute to the point of being almost imperceptible.</p>
</div>
<div id="smoothpercentilewidth-comparisons" class="section level2">
<h2><code>smoothPercentileWidth</code> comparisons</h2>
<p>Seeing now that the choice of the <code>pctile</code> threshold may create results different enough as to produce a different counts of events, we need to look closer at the different arguments. I have my suspicions that the smoothing of the threshold values may be the culprit here.</p>
<pre class="r"><code>spw_no_r &lt;- detect_event(ts2clm(data = sst_WA, smoothPercentile = FALSE,
                                climatologyPeriod = c(&quot;1982-01-01&quot;, &quot;2014-12-31&quot;)))
spw_11_r &lt;- detect_event(ts2clm(data = sst_WA, smoothPercentileWidth = 11,
                                climatologyPeriod = c(&quot;1982-01-01&quot;, &quot;2014-12-31&quot;)))
spw_51_r &lt;- detect_event(ts2clm(data = sst_WA, smoothPercentileWidth = 51,
                                climatologyPeriod = c(&quot;1982-01-01&quot;, &quot;2014-12-31&quot;)))</code></pre>
<pre class="python"><code># smoothPercentileWidth = FALSE
mhws, clim = mhw.detect(t, sst, smoothPercentile = False)
mhws_df = pd.DataFrame.from_dict(mhws)
mhws_df.to_csv(&#39;data/mhws_py_spw_no.csv&#39;, sep = &#39;,&#39;, index = False)
clim_df = pd.DataFrame.from_dict(clim)
clim_df.to_csv(&#39;data/clim_py_spw_no.csv&#39;, sep = &#39;,&#39;, index = False)
# smoothPercentileWidth = 11
mhws, clim = mhw.detect(t, sst, smoothPercentileWidth = 11)
mhws_df = pd.DataFrame.from_dict(mhws)
mhws_df.to_csv(&#39;data/mhws_py_spw_11.csv&#39;, sep = &#39;,&#39;, index = False)
clim_df = pd.DataFrame.from_dict(clim)
clim_df.to_csv(&#39;data/clim_py_spw_11.csv&#39;, sep = &#39;,&#39;, index = False)
# smoothPercentileWidth = 51
mhws, clim = mhw.detect(t, sst, smoothPercentileWidth = 51)
mhws_df = pd.DataFrame.from_dict(mhws)
mhws_df.to_csv(&#39;data/mhws_py_spw_51.csv&#39;, sep = &#39;,&#39;, index = False)
clim_df = pd.DataFrame.from_dict(clim)
clim_df.to_csv(&#39;data/clim_py_spw_51.csv&#39;, sep = &#39;,&#39;, index = False)</code></pre>
<pre class="r"><code># Load Python
spw_no_py_event &lt;- read_csv(&quot;data/mhws_py_spw_no.csv&quot;)
spw_no_py_clim &lt;- read_csv(&quot;data/clim_py_spw_no.csv&quot;)
spw_11_py_event &lt;- read_csv(&quot;data/mhws_py_spw_11.csv&quot;)
spw_11_py_clim &lt;- read_csv(&quot;data/clim_py_spw_11.csv&quot;)
spw_51_py_event &lt;- read_csv(&quot;data/mhws_py_spw_51.csv&quot;)
spw_51_py_clim &lt;- read_csv(&quot;data/clim_py_spw_51.csv&quot;)

# Compare clims and intensities
# no smoothing
cor(spw_no_r$climatology$seas, spw_no_py_clim$seas)
sum(spw_no_r$climatology$seas) - sum(spw_no_py_clim$seas)
cor(spw_no_r$climatology$thresh, spw_no_py_clim$thresh)
sum(spw_no_r$climatology$thresh) - sum(spw_no_py_clim$thresh)
sum(spw_no_r$event$intensity_cumulative) - sum(spw_no_py_event$intensity_cumulative)
sum(spw_no_r$event$intensity_max) - sum(spw_no_py_event$intensity_max)
# 11 days
cor(spw_11_r$climatology$seas, spw_11_py_clim$seas)
sum(spw_11_r$climatology$seas) - sum(spw_11_py_clim$seas)
cor(spw_11_r$climatology$thresh, spw_11_py_clim$thresh)
sum(spw_11_r$climatology$thresh) - sum(spw_11_py_clim$thresh)
sum(spw_11_r$event$intensity_cumulative) - sum(spw_11_py_event$intensity_cumulative)
sum(spw_11_r$event$intensity_max) - sum(spw_11_py_event$intensity_max)
# 51 days
cor(spw_51_r$climatology$seas, spw_51_py_clim$seas)
sum(spw_51_r$climatology$seas) - sum(spw_51_py_clim$seas)
cor(spw_51_r$climatology$thresh, spw_51_py_clim$thresh)
sum(spw_51_r$climatology$thresh) - sum(spw_51_py_clim$thresh)
sum(spw_51_r$event$intensity_cumulative) - sum(spw_51_py_event$intensity_cumulative)
sum(spw_51_r$event$intensity_max) - sum(spw_51_py_event$intensity_max)

# Compare events
spw_no_event &lt;- compare_event(spw_no_r$event, spw_no_py_event)
spw_no_event
spw_11_event &lt;- compare_event(spw_11_r$event, spw_11_py_event)
spw_11_event
spw_51_event &lt;- compare_event(spw_51_r$event, spw_51_py_event)
spw_51_event</code></pre>
<p>Surprisingly the smoothing window, regardless if it is applied or not, seems to make little difference. But again, let’s compare the old R code against Python as well.</p>
<pre class="r"><code>ts &lt;- RmarineHeatWaves::make_whole(sst_WA)
spw_no_r_old &lt;- RmarineHeatWaves::detect(data = ts, climatology_start = &quot;1982-01-01&quot;, climatology_end = &quot;2014-12-31&quot;, smooth_percentile = FALSE)
spw_no_r_old_event &lt;- spw_no_r_old$event
spw_no_r_old_clim &lt;- spw_no_r_old$clim

# Compare new and old R code
sum(spw_no_r$climatology$seas) - sum(spw_no_r_old_clim$seas_clim_year)
sum(spw_no_r$climatology$thresh) - sum(spw_no_r_old_clim$thresh_clim_year)

# Compare old &amp; new R against Python
sum(spw_no_py_clim$seas) - sum(spw_no_r_old_clim$seas_clim_year)
sum(spw_no_py_clim$seas) - sum(spw_no_r$climatology$seas)
sum(spw_no_py_clim$thresh) - sum(spw_no_r_old_clim$thresh_clim_year)
sum(spw_no_py_clim$thresh) - sum(spw_no_r$climatology$thresh)</code></pre>
<p>Again, almost no difference.</p>
</div>
<div id="windowhalfwidth-comparisons" class="section level2">
<h2><code>windowHalfWidth</code> comparisons</h2>
<p>We’ve now seen that the differences between both the new &amp; old R code and the Python code hold consistently different regardless of the changing of the <code>pctile</code> or <code>smoothWindowPercentile</code>. This then leads me to think that this is just a rounding issue between the two languages, and that there is not some fundamentally different calculation happening somewhere in the code. That being said, it is still necessary to be thorough and so I’ll go through the rest of the arguments now. Starting with <code>windowHalfWidth</code>.</p>
<pre class="r"><code>whw_3_r &lt;- detect_event(ts2clm(data = sst_WA, windowHalfWidth = 3,
                               climatologyPeriod = c(&quot;1982-01-01&quot;, &quot;2014-12-31&quot;)))
whw_7_r &lt;- detect_event(ts2clm(data = sst_WA, windowHalfWidth = 7,
                               climatologyPeriod = c(&quot;1982-01-01&quot;, &quot;2014-12-31&quot;)))</code></pre>
<pre class="python"><code># windowHalfWidth = 3
mhws, clim = mhw.detect(t, sst, windowHalfWidth = 3)
mhws_df = pd.DataFrame.from_dict(mhws)
mhws_df.to_csv(&#39;data/mhws_py_whw_3.csv&#39;, sep = &#39;,&#39;, index = False)
clim_df = pd.DataFrame.from_dict(clim)
clim_df.to_csv(&#39;data/clim_py_whw_3.csv&#39;, sep = &#39;,&#39;, index = False)
# windowHalfWidth = 7
mhws, clim = mhw.detect(t, sst, windowHalfWidth = 7)
mhws_df = pd.DataFrame.from_dict(mhws)
mhws_df.to_csv(&#39;data/mhws_py_whw_7.csv&#39;, sep = &#39;,&#39;, index = False)
clim_df = pd.DataFrame.from_dict(clim)
clim_df.to_csv(&#39;data/clim_py_whw_7.csv&#39;, sep = &#39;,&#39;, index = False)</code></pre>
<pre class="r"><code># Load Python
whw_3_py_event &lt;- read_csv(&quot;data/mhws_py_whw_3.csv&quot;)
whw_3_py_clim &lt;- read_csv(&quot;data/clim_py_whw_3.csv&quot;)
whw_7_py_event &lt;- read_csv(&quot;data/mhws_py_whw_7.csv&quot;)
whw_7_py_clim &lt;- read_csv(&quot;data/clim_py_whw_7.csv&quot;)

# Compare clims and intensities
# 3 days
cor(whw_3_r$climatology$seas, whw_3_py_clim$seas)
sum(whw_3_r$climatology$seas) - sum(whw_3_py_clim$seas)
cor(whw_3_r$climatology$thresh, whw_3_py_clim$thresh)
sum(whw_3_r$climatology$thresh) - sum(whw_3_py_clim$thresh)
sum(whw_3_r$event$intensity_cumulative) - sum(whw_3_py_event$intensity_cumulative)
sum(whw_3_r$event$intensity_max) - sum(whw_3_py_event$intensity_max)
# 7 days
cor(whw_7_r$climatology$seas, whw_7_py_clim$seas)
sum(whw_7_r$climatology$seas) - sum(whw_7_py_clim$seas)
cor(whw_7_r$climatology$thresh, whw_7_py_clim$thresh)
sum(whw_7_r$climatology$thresh) - sum(whw_7_py_clim$thresh)
sum(whw_7_r$event$intensity_cumulative) - sum(whw_7_py_event$intensity_cumulative)
sum(whw_7_r$event$intensity_max) - sum(whw_7_py_event$intensity_max)

# Compare events
whw_3_event &lt;- compare_event(whw_3_r$event, whw_3_py_event)
whw_3_event
# whw_7_event &lt;- compare_event(whw_7_r$event, whw_7_py_event)
# whw_7_event</code></pre>
<p>We see here that the <code>windowHalfWidth</code> has a large effect on the difference between the results than anything else so far. The difference per row is still low at ~0.001 so isn’t much cause for alarm. We do however detect a different number of events if <code>windowHalfWidth = 7</code>. Let’s see how they differ.</p>
<pre class="r"><code>whw_7_r_event &lt;- whw_7_r$event
whw_7_r_event$date_start[!whw_7_r_event$date_start %in% whw_7_py_event$date_start]</code></pre>
<p>The difference lies in the R code detecting a five day event that the Python code must have seen as only 4 days or less. Again due to very narrow differences in the threshold values.</p>
<p>Let’s look if there is a difference between the old and new R code.</p>
<pre class="r"><code>ts &lt;- RmarineHeatWaves::make_whole(sst_WA)
whw_7_r_old &lt;- RmarineHeatWaves::detect(data = ts, climatology_start = &quot;1982-01-01&quot;, climatology_end = &quot;2014-12-31&quot;, window_half_width = 7)

# Compare new and old R code
sum(whw_7_r$climatology$seas) - sum(whw_7_r_old$clim$seas_clim_year)
sum(whw_7_r$climatology$thresh) - sum(whw_7_r_old$clim$thresh_clim_year)
sum(whw_7_r$event$intensity_cumulative) - sum(whw_7_r_old$event$int_cum)
sum(whw_7_r$event$intensity_max) - sum(whw_7_r_old$event$int_max)</code></pre>
<p>Everything matches up between old and new R for <code>windowHalfWidth = 7</code>.</p>
</div>
<div id="minduration-comparisons" class="section level2">
<h2><code>minDuration</code> comparisons</h2>
<p>Now we move away form the arguments that effect the climatology calculations, and focus just on those that determine the classification of events.</p>
<pre class="r"><code>minD_3_r &lt;- detect_event(ts2clm(data = sst_WA, climatologyPeriod = c(&quot;1982-01-01&quot;, &quot;2014-12-31&quot;)), 
                         minDuration = 3)
minD_7_r &lt;- detect_event(ts2clm(data = sst_WA, climatologyPeriod = c(&quot;1982-01-01&quot;, &quot;2014-12-31&quot;)), 
                         minDuration = 7)</code></pre>
<pre class="python"><code># minDuration = 3
mhws, clim = mhw.detect(t, sst, minDuration = 3)
mhws_df = pd.DataFrame.from_dict(mhws)
mhws_df.to_csv(&#39;data/mhws_py_minD_3.csv&#39;, sep = &#39;,&#39;, index = False)
clim_df = pd.DataFrame.from_dict(clim)
clim_df.to_csv(&#39;data/clim_py_minD_3.csv&#39;, sep = &#39;,&#39;, index = False)
# minDuration = 7
mhws, clim = mhw.detect(t, sst, minDuration = 7)
mhws_df = pd.DataFrame.from_dict(mhws)
mhws_df.to_csv(&#39;data/mhws_py_minD_7.csv&#39;, sep = &#39;,&#39;, index = False)
clim_df = pd.DataFrame.from_dict(clim)
clim_df.to_csv(&#39;data/clim_py_minD_7.csv&#39;, sep = &#39;,&#39;, index = False)</code></pre>
<pre class="r"><code># Load Python
minD_3_py_event &lt;- read_csv(&quot;data/mhws_py_minD_3.csv&quot;)
minD_3_py_clim &lt;- read_csv(&quot;data/clim_py_minD_3.csv&quot;)
minD_7_py_event &lt;- read_csv(&quot;data/mhws_py_minD_7.csv&quot;)
minD_7_py_clim &lt;- read_csv(&quot;data/clim_py_minD_7.csv&quot;)

# Compare clims and intensities
# 3 days
cor(minD_3_r$climatology$seas, minD_3_py_clim$seas)
sum(minD_3_r$climatology$seas) - sum(minD_3_py_clim$seas)
cor(minD_3_r$climatology$thresh, minD_3_py_clim$thresh)
sum(minD_3_r$climatology$thresh) - sum(minD_3_py_clim$thresh)
sum(minD_3_r$event$intensity_cumulative) - sum(minD_3_py_event$intensity_cumulative)
sum(minD_3_r$event$intensity_max) - sum(minD_3_py_event$intensity_max)
# 7 days
cor(minD_7_r$climatology$seas, minD_7_py_clim$seas)
sum(minD_7_r$climatology$seas) - sum(minD_7_py_clim$seas)
cor(minD_7_r$climatology$thresh, minD_7_py_clim$thresh)
sum(minD_7_r$climatology$thresh) - sum(minD_7_py_clim$thresh)
sum(minD_7_r$event$intensity_cumulative) - sum(minD_7_py_event$intensity_cumulative)
sum(minD_7_r$event$intensity_max) - sum(minD_7_py_event$intensity_max)

# Compare events
minD_3_event &lt;- compare_event(minD_3_r$event, minD_3_py_event)
minD_3_event
minD_7_event &lt;- compare_event(minD_7_r$event, minD_7_py_event)
minD_7_event</code></pre>
<p>As expected, changing the minimum duration of events has no effect on the threshold calculations. It is however gratifying to see that the same number of events is calculated between languages, regardless of the minimum duration. The difference these cause in the intensities of the events is also negligible between languages.</p>
</div>
<div id="joinacrossgaps-comparisons" class="section level2">
<h2><code>joinAcrossGaps</code> comparisons</h2>
<p>Now for the final argument in the base functionality. This too should not effect the climatologies. Only the events.</p>
<pre class="r"><code>joinAG_no_r &lt;- detect_event(ts2clm(data = sst_WA, climatologyPeriod = c(&quot;1982-01-01&quot;, &quot;2014-12-31&quot;)), 
                            joinAcrossGaps = FALSE)
joinAG_1_r &lt;- detect_event(ts2clm(data = sst_WA, climatologyPeriod = c(&quot;1982-01-01&quot;, &quot;2014-12-31&quot;)), 
                           maxGap = 1)
joinAG_5_r &lt;- detect_event(ts2clm(data = sst_WA, climatologyPeriod = c(&quot;1982-01-01&quot;, &quot;2014-12-31&quot;)), 
                           maxGap = 5)</code></pre>
<pre class="python"><code># joinAGuration = False
mhws, clim = mhw.detect(t, sst, joinAcrossGaps = False)
mhws_df = pd.DataFrame.from_dict(mhws)
mhws_df.to_csv(&#39;data/mhws_py_joinAG_no.csv&#39;, sep = &#39;,&#39;, index = False)
clim_df = pd.DataFrame.from_dict(clim)
clim_df.to_csv(&#39;data/clim_py_joinAG_no.csv&#39;, sep = &#39;,&#39;, index = False)
# maxGap = 1
mhws, clim = mhw.detect(t, sst, maxGap = 1)
mhws_df = pd.DataFrame.from_dict(mhws)
mhws_df.to_csv(&#39;data/mhws_py_joinAG_1.csv&#39;, sep = &#39;,&#39;, index = False)
clim_df = pd.DataFrame.from_dict(clim)
clim_df.to_csv(&#39;data/clim_py_joinAG_1.csv&#39;, sep = &#39;,&#39;, index = False)
# maxGap = 5
mhws, clim = mhw.detect(t, sst, maxGap = 5)
mhws_df = pd.DataFrame.from_dict(mhws)
mhws_df.to_csv(&#39;data/mhws_py_joinAG_5.csv&#39;, sep = &#39;,&#39;, index = False)
clim_df = pd.DataFrame.from_dict(clim)
clim_df.to_csv(&#39;data/clim_py_joinAG_5.csv&#39;, sep = &#39;,&#39;, index = False)</code></pre>
<pre class="r"><code># Load Python
joinAG_no_py_event &lt;- read_csv(&quot;data/mhws_py_joinAG_no.csv&quot;)
joinAG_no_py_clim &lt;- read_csv(&quot;data/clim_py_joinAG_no.csv&quot;)
joinAG_1_py_event &lt;- read_csv(&quot;data/mhws_py_joinAG_1.csv&quot;)
joinAG_1_py_clim &lt;- read_csv(&quot;data/clim_py_joinAG_1.csv&quot;)
joinAG_5_py_event &lt;- read_csv(&quot;data/mhws_py_joinAG_5.csv&quot;)
joinAG_5_py_clim &lt;- read_csv(&quot;data/clim_py_joinAG_5.csv&quot;)

# Compare clims and intensities
# no days
cor(joinAG_no_r$climatology$seas, joinAG_no_py_clim$seas)
sum(joinAG_no_r$climatology$seas) - sum(joinAG_no_py_clim$seas)
cor(joinAG_no_r$climatology$thresh, joinAG_no_py_clim$thresh)
sum(joinAG_no_r$climatology$thresh) - sum(joinAG_no_py_clim$thresh)
sum(joinAG_no_r$event$intensity_cumulative) - sum(joinAG_no_py_event$intensity_cumulative)
sum(joinAG_no_r$event$intensity_max) - sum(joinAG_no_py_event$intensity_max)
# 1 day
cor(joinAG_1_r$climatology$seas, joinAG_1_py_clim$seas)
sum(joinAG_1_r$climatology$seas) - sum(joinAG_1_py_clim$seas)
cor(joinAG_1_r$climatology$thresh, joinAG_1_py_clim$thresh)
sum(joinAG_1_r$climatology$thresh) - sum(joinAG_1_py_clim$thresh)
sum(joinAG_1_r$event$intensity_cumulative) - sum(joinAG_1_py_event$intensity_cumulative)
sum(joinAG_1_r$event$intensity_max) - sum(joinAG_1_py_event$intensity_max)
# 7 days
cor(joinAG_5_r$climatology$seas, joinAG_5_py_clim$seas)
sum(joinAG_5_r$climatology$seas) - sum(joinAG_5_py_clim$seas)
cor(joinAG_5_r$climatology$thresh, joinAG_5_py_clim$thresh)
sum(joinAG_5_r$climatology$thresh) - sum(joinAG_5_py_clim$thresh)
sum(joinAG_5_r$event$intensity_cumulative) - sum(joinAG_5_py_event$intensity_cumulative)
sum(joinAG_5_r$event$intensity_max) - sum(joinAG_5_py_event$intensity_max)

# Compare events
joinAG_no_event &lt;- compare_event(joinAG_no_r$event, joinAG_no_py_event)
joinAG_no_event
joinAG_1_event &lt;- compare_event(joinAG_1_r$event, joinAG_1_py_event)
joinAG_1_event
joinAG_5_event &lt;- compare_event(joinAG_5_r$event, joinAG_5_py_event)
joinAG_5_event</code></pre>
<p>A little surprising, but good to see, is that the length of gap between events does not cause a different number of events to be calculated between languages considering all other arguments are kept at the default.</p>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>It appears as though, down to a very small degree, there are differences between the outputs of the two languages. That being said, these differences appear to be due to the rounding differences that exist between the languages and so it is not a fault of the code in either, nor are there fundamentally different processes being employed to make the calculations. Indeed, though minute differences may be found in the calculations of the seasonal and threshold climatologies, these differences are consistent. They do not vary. They may change in magnitude depending on the arguments supplied, but these differences never become larger than ~0.001 per row, which has been deemed here as acceptable. Interestingly, though not surprising in hindsight, is that the changing of the <code>windowHalfWidth</code> argument causes the largest difference between the languages. This makes sense because this argument determines how many values are meaned together in the beginning of the climatology calculations. And as the differences are due to rounding, that numerical fingerprint is boldest here.</p>
<p>Depending on how some of the arguments were tweaked, the two languages very rarely would detect one event more or less than the other. This was due to the odd day being just above or below the threshold by ~0.001 degrees or so. Very rare, but so is existence, hypothetically.</p>
<p>Ultimately, I am very confident in saying that the outputs of these two languages are comparable.</p>
<div id="refs">

</div>
</div>
<div id="session-information" class="section level2">
<h2>Session information</h2>
<pre class="r"><code>sessionInfo()</code></pre>
</div>

<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>

<hr>
<p>
  This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a>
  analysis was created with
  <a href="https://github.com/jdblischak/workflowr">workflowr</a> 1.1.1
</p>
<hr>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
