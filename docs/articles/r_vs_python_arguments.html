<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Arguments for MHW outputs in R and Python • MHWdetection</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Arguments for MHW outputs in R and Python">
<meta property="og:description" content="This vignette compares the code/work flow for altering the additional arguments found within the base Python and R detection function.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MHWdetection</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/r_vs_python.html">Python vs. R - default outputs</a>
    </li>
    <li>
      <a href="../articles/r_vs_python_arguments.html">Python vs. R - default arguments</a>
    </li>
    <li>
      <a href="../articles/r_vs_python_additional.html">Python vs. R - additional functions</a>
    </li>
    <li>
      <a href="../articles/Short_climatologies.html">Short climatologies</a>
    </li>
    <li>
      <a href="../articles/Climatologies_and_baselines.html">Alternative climatologies and baselines</a>
    </li>
    <li>
      <a href="../articles/time_series_duration.html">Effects of short time series</a>
    </li>
    <li>
      <a href="../articles/missing_data.html">Effects of missing data</a>
    </li>
    <li>
      <a href="../articles/gridded_products.html">Difference between gridded products</a>
    </li>
    <li>
      <a href="../articles/best_practices.html">Best practices</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/robwschlegel/MHWdetection">
    <span class="fa fa-github fa-lg"></span>
     
    github
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Arguments for MHW outputs in R and Python</h1>
                        <h4 class="author">Robert W Schlegel</h4>
            
            <h4 class="date">2019-01-23</h4>
      
      
      <div class="hidden name"><code>r_vs_python_arguments.Rmd</code></div>

    </div>

    
    
<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>Building on the default functionality shared between the two languages, this vignette goes further to look at how changing the default arguments may affect the results. Along the way the outputs are checked for consistency and all of the arguments for all of the functions are tweaked to look for irregularities. This is necessary before only one language is used to further investigate best practices for dealing with sub-optimal time series in the detection of MHWs.</p>
<p>Preferably this step could have been done programmatically, without creating an army of outputs as seen below. The R package <strong><code>reticulate</code></strong> does not seem to want to play along though so I must rather run the Python code, save the outputs, load them into R and compare the results natively in just R… So let’s get started.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyverse)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggpubr)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(heatwaveR)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(reticulate)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/reticulate/topics/use_python">use_condaenv</a></span>(<span class="st">"py27"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="im">import</span> numpy <span class="im">as</span> np</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="im">from</span> datetime <span class="im">import</span> date</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="im">import</span> pandas <span class="im">as</span> pd</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="im">import</span> marineHeatWaves <span class="im">as</span> mhw</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co"># The date values</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">t <span class="op">=</span> np.arange(date(<span class="dv">1982</span>,<span class="dv">1</span>,<span class="dv">1</span>).toordinal(),date(<span class="dv">2014</span>,<span class="dv">12</span>,<span class="dv">31</span>).toordinal()<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co"># The temperature values</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">sst <span class="op">=</span> np.loadtxt(<span class="bu">open</span>(<span class="st">"data/sst_WA.csv"</span>, <span class="st">"r"</span>), delimiter <span class="op">=</span> <span class="st">','</span>, skiprows <span class="op">=</span> <span class="dv">1</span>)</a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># The default python output from the previous comparison vignette</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">default_py_event &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/mhws_py.csv"</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">default_py_clim &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/clim_py.csv"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># The default R output</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">default_r &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/detect_event">detect_event</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/ts2clm">ts2clm</a></span>(<span class="dt">data =</span> sst_WA,</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">                                 <span class="dt">climatologyPeriod =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1982-01-01"</span>, <span class="st">"2014-12-31"</span>)))</a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">compare_event &lt;-<span class="st"> </span><span class="cf">function</span>(res_event_R, res_event_Python){</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">  <span class="co"># Remove non-numeric columns</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  res_event_num &lt;-<span class="st"> </span>res_event_R <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="st">    </span><span class="kw">select_if</span>(is.numeric)</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  <span class="co"># Run the loop</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">  res_event_cor &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>()</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(res_event_num))){</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">    <span class="cf">if</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(res_event_num)[i] <span class="op">%in%</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(res_event_Python)){</a>
<a class="sourceLine" id="cb6-9" data-line-number="9">      x1 &lt;-<span class="st"> </span>res_event_R[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(res_event_R) <span class="op">==</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(res_event_num)[i]]</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">      x2 &lt;-<span class="st"> </span>res_event_Python[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(res_event_Python) <span class="op">==</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(res_event_num)[i]]</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">      x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">r =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(x1, x2), <span class="dt">var =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(res_event_num)[i])</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(x)[<span class="dv">1</span>] &lt;-<span class="st"> "r"</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13">      <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(x) &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14">      } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb6-15" data-line-number="15">        x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">r =</span> <span class="ot">NA</span>, <span class="dt">var =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(res_event_num)[i])</a>
<a class="sourceLine" id="cb6-16" data-line-number="16">        }</a>
<a class="sourceLine" id="cb6-17" data-line-number="17">    res_event_cor &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(res_event_cor, x)</a>
<a class="sourceLine" id="cb6-18" data-line-number="18">    }</a>
<a class="sourceLine" id="cb6-19" data-line-number="19">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(res_event_cor)</a>
<a class="sourceLine" id="cb6-20" data-line-number="20">  }</a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Compare default clims and intensities</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(default_r<span class="op">$</span>climatology<span class="op">$</span>seas, default_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] 0.9999999</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_r<span class="op">$</span>climatology<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] -2.053821</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(default_r<span class="op">$</span>climatology<span class="op">$</span>thresh, default_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] 0.9999996</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_r<span class="op">$</span>climatology<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] -6.573385</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_r<span class="op">$</span>event<span class="op">$</span>intensity_cumulative) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_py_event<span class="op">$</span>intensity_cumulative)</a></code></pre></div>
<pre><code>## [1] 0.1630294</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_r<span class="op">$</span>event<span class="op">$</span>intensity_max) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_py_event<span class="op">$</span>intensity_max)</a></code></pre></div>
<pre><code>## [1] 0.008673771</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># Compare default events</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">default_event &lt;-<span class="st"> </span><span class="kw">compare_event</span>(default_r<span class="op">$</span>event, default_py_event)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">default_event</a></code></pre></div>
<pre><code>##            r                            var
## 1         NA                       event_no
## 2  1.0000000                    index_start
## 3  1.0000000                     index_peak
## 4  1.0000000                      index_end
## 5  1.0000000                       duration
## 6  0.9999991                 intensity_mean
## 7  0.9999997                  intensity_max
## 8  0.9996073                  intensity_var
## 9  1.0000000           intensity_cumulative
## 10 0.9999971       intensity_mean_relThresh
## 11 0.9999994        intensity_max_relThresh
## 12 0.9995693        intensity_var_relThresh
## 13 0.9999996 intensity_cumulative_relThresh
## 14 1.0000000             intensity_mean_abs
## 15 0.9990733              intensity_max_abs
## 16 0.9997263              intensity_var_abs
## 17 1.0000000       intensity_cumulative_abs
## 18 0.9999999                     rate_onset
## 19 0.9999999                   rate_decline</code></pre>
</div>
<div id="pctile-comparisons" class="section level2">
<h2 class="hasAnchor">
<a href="#pctile-comparisons" class="anchor"></a><code>pctile</code> comparisons</h2>
<p>Here we look at a few possible settings for the <code>pctile</code> argument and ensure that everything matches up.</p>
<p>First run and save the Python output.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># pctile = 80</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">mhws, clim <span class="op">=</span> mhw.detect(t, sst, pctile <span class="op">=</span> <span class="dv">80</span>)</a>
<a class="sourceLine" id="cb21-3" data-line-number="3">mhws_df <span class="op">=</span> pd.DataFrame.from_dict(mhws)</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">mhws_df.to_csv(<span class="st">'data/mhws_py_pctile_80.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb21-5" data-line-number="5">clim_df <span class="op">=</span> pd.DataFrame.from_dict(clim)</a>
<a class="sourceLine" id="cb21-6" data-line-number="6">clim_df.to_csv(<span class="st">'data/clim_py_pctile_80.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb21-7" data-line-number="7"><span class="co"># pctile = 95</span></a>
<a class="sourceLine" id="cb21-8" data-line-number="8">mhws, clim <span class="op">=</span> mhw.detect(t, sst, pctile <span class="op">=</span> <span class="dv">95</span>)</a>
<a class="sourceLine" id="cb21-9" data-line-number="9">mhws_df <span class="op">=</span> pd.DataFrame.from_dict(mhws)</a>
<a class="sourceLine" id="cb21-10" data-line-number="10">mhws_df.to_csv(<span class="st">'data/mhws_py_pctile_95.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb21-11" data-line-number="11">clim_df <span class="op">=</span> pd.DataFrame.from_dict(clim)</a>
<a class="sourceLine" id="cb21-12" data-line-number="12">clim_df.to_csv(<span class="st">'data/clim_py_pctile_95.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb21-13" data-line-number="13"><span class="co"># pctile = 99</span></a>
<a class="sourceLine" id="cb21-14" data-line-number="14">mhws, clim <span class="op">=</span> mhw.detect(t, sst, pctile <span class="op">=</span> <span class="dv">99</span>)</a>
<a class="sourceLine" id="cb21-15" data-line-number="15">mhws_df <span class="op">=</span> pd.DataFrame.from_dict(mhws)</a>
<a class="sourceLine" id="cb21-16" data-line-number="16">mhws_df.to_csv(<span class="st">'data/mhws_py_pctile_99.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb21-17" data-line-number="17">clim_df <span class="op">=</span> pd.DataFrame.from_dict(clim)</a>
<a class="sourceLine" id="cb21-18" data-line-number="18">clim_df.to_csv(<span class="st">'data/clim_py_pctile_99.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a></code></pre></div>
<p>Then run the R output.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">pctile_<span class="dv">80</span>_r &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/detect_event">detect_event</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/ts2clm">ts2clm</a></span>(<span class="dt">data =</span> sst_WA, <span class="dt">pctile =</span> <span class="dv">80</span>,</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">                                   <span class="dt">climatologyPeriod =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1982-01-01"</span>, <span class="st">"2014-12-31"</span>)))</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">pctile_<span class="dv">95</span>_r &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/detect_event">detect_event</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/ts2clm">ts2clm</a></span>(<span class="dt">data =</span> sst_WA, <span class="dt">pctile =</span> <span class="dv">95</span>,</a>
<a class="sourceLine" id="cb22-4" data-line-number="4">                                   <span class="dt">climatologyPeriod =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1982-01-01"</span>, <span class="st">"2014-12-31"</span>)))</a>
<a class="sourceLine" id="cb22-5" data-line-number="5">pctile_<span class="dv">99</span>_r &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/detect_event">detect_event</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/ts2clm">ts2clm</a></span>(<span class="dt">data =</span> sst_WA, <span class="dt">pctile =</span> <span class="dv">99</span>,</a>
<a class="sourceLine" id="cb22-6" data-line-number="6">                                   <span class="dt">climatologyPeriod =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1982-01-01"</span>, <span class="st">"2014-12-31"</span>)))</a></code></pre></div>
<p>Lastly load the Python output and compare the two.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># Load Python</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2">pctile_<span class="dv">80</span>_py_event &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/mhws_py_pctile_80.csv"</span>)</a>
<a class="sourceLine" id="cb23-3" data-line-number="3">pctile_<span class="dv">80</span>_py_clim &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/clim_py_pctile_80.csv"</span>)</a>
<a class="sourceLine" id="cb23-4" data-line-number="4">pctile_<span class="dv">95</span>_py_event &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/mhws_py_pctile_95.csv"</span>)</a>
<a class="sourceLine" id="cb23-5" data-line-number="5">pctile_<span class="dv">95</span>_py_clim &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/clim_py_pctile_95.csv"</span>)</a>
<a class="sourceLine" id="cb23-6" data-line-number="6">pctile_<span class="dv">99</span>_py_event &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/mhws_py_pctile_99.csv"</span>)</a>
<a class="sourceLine" id="cb23-7" data-line-number="7">pctile_<span class="dv">99</span>_py_clim &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/clim_py_pctile_99.csv"</span>)</a>
<a class="sourceLine" id="cb23-8" data-line-number="8"></a>
<a class="sourceLine" id="cb23-9" data-line-number="9"><span class="co"># Compare clims and intensities</span></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"><span class="co"># 80</span></a>
<a class="sourceLine" id="cb23-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(pctile_<span class="dv">80</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas, pctile_<span class="dv">80</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] 0.9999999</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">80</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">80</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] -2.053821</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(pctile_<span class="dv">80</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh, pctile_<span class="dv">80</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] 0.9999982</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">80</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">80</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] -14.013</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">80</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_cumulative) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">80</span>_py_event<span class="op">$</span>intensity_cumulative)</a></code></pre></div>
<pre><code>## [1] 2.444108</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">80</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_max) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">80</span>_py_event<span class="op">$</span>intensity_max)</a></code></pre></div>
<pre><code>## [1] -1.102694</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="co"># 95</span></a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(pctile_<span class="dv">95</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas, pctile_<span class="dv">95</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] 0.9999999</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">95</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">95</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] -2.053821</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(pctile_<span class="dv">95</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh, pctile_<span class="dv">95</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] 0.9999999</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">95</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">95</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] -3.402085</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">95</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_cumulative) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">95</span>_py_event<span class="op">$</span>intensity_cumulative)</a></code></pre></div>
<pre><code>## [1] 0.06129223</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">95</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_max) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">95</span>_py_event<span class="op">$</span>intensity_max)</a></code></pre></div>
<pre><code>## [1] 0.007555896</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="co"># 99</span></a>
<a class="sourceLine" id="cb47-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(pctile_<span class="dv">99</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas, pctile_<span class="dv">99</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] 0.9999999</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">99</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">99</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] -2.053821</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(pctile_<span class="dv">99</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh, pctile_<span class="dv">99</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] 0.9999944</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">99</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">99</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] 28.39465</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">99</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_cumulative) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">99</span>_py_event<span class="op">$</span>intensity_cumulative)</a></code></pre></div>
<pre><code>## [1] -0.003142188</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">99</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_max) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(pctile_<span class="dv">99</span>_py_event<span class="op">$</span>intensity_max)</a></code></pre></div>
<pre><code>## [1] -0.0002594781</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="co"># Compare events</span></a>
<a class="sourceLine" id="cb59-2" data-line-number="2"><span class="co"># pctile_80_event &lt;- compare_event(pctile_80_r$event, pctile_80_py_event)</span></a>
<a class="sourceLine" id="cb59-3" data-line-number="3">pctile_<span class="dv">95</span>_event &lt;-<span class="st"> </span><span class="kw">compare_event</span>(pctile_<span class="dv">95</span>_r<span class="op">$</span>event, pctile_<span class="dv">95</span>_py_event)</a>
<a class="sourceLine" id="cb59-4" data-line-number="4">pctile_<span class="dv">95</span>_event</a></code></pre></div>
<pre><code>##            r                            var
## 1         NA                       event_no
## 2  1.0000000                    index_start
## 3  1.0000000                     index_peak
## 4  1.0000000                      index_end
## 5  1.0000000                       duration
## 6  0.9999988                 intensity_mean
## 7  0.9999996                  intensity_max
## 8  0.9988679                  intensity_var
## 9  1.0000000           intensity_cumulative
## 10 0.9999979       intensity_mean_relThresh
## 11 0.9999468        intensity_max_relThresh
## 12 0.9988432        intensity_var_relThresh
## 13 0.9999999 intensity_cumulative_relThresh
## 14 1.0000000             intensity_mean_abs
## 15 0.9997819              intensity_max_abs
## 16 0.9990657              intensity_var_abs
## 17 1.0000000       intensity_cumulative_abs
## 18 0.9999998                     rate_onset
## 19 1.0000000                   rate_decline</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1">pctile_<span class="dv">99</span>_event &lt;-<span class="st"> </span><span class="kw">compare_event</span>(pctile_<span class="dv">99</span>_r<span class="op">$</span>event, pctile_<span class="dv">99</span>_py_event)</a>
<a class="sourceLine" id="cb61-2" data-line-number="2">pctile_<span class="dv">99</span>_event</a></code></pre></div>
<pre><code>##            r                            var
## 1         NA                       event_no
## 2  1.0000000                    index_start
## 3  1.0000000                     index_peak
## 4  1.0000000                      index_end
## 5  1.0000000                       duration
## 6  1.0000000                 intensity_mean
## 7  1.0000000                  intensity_max
## 8  0.9995120                  intensity_var
## 9  1.0000000           intensity_cumulative
## 10 0.9999043       intensity_mean_relThresh
## 11 0.9999951        intensity_max_relThresh
## 12 0.9993619        intensity_var_relThresh
## 13 0.9999383 intensity_cumulative_relThresh
## 14 1.0000000             intensity_mean_abs
## 15 1.0000000              intensity_max_abs
## 16 0.9991278              intensity_var_abs
## 17 1.0000000       intensity_cumulative_abs
## 18 1.0000000                     rate_onset
## 19 1.0000000                   rate_decline</code></pre>
<p>There appears to be an issue with the results when the threshold is set to <code>pctile = 80</code> as Python detects one more event than R. Let’s take a closer look.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1">pctile_<span class="dv">80</span>_r_event &lt;-<span class="st"> </span>pctile_<span class="dv">80</span>_r<span class="op">$</span>event</a>
<a class="sourceLine" id="cb63-2" data-line-number="2">pctile_<span class="dv">80</span>_py_event<span class="op">$</span>date_start[<span class="op">!</span>pctile_<span class="dv">80</span>_py_event<span class="op">$</span>date_start <span class="op">%in%</span><span class="st"> </span>pctile_<span class="dv">80</span>_r_event<span class="op">$</span>date_start]</a></code></pre></div>
<pre><code>## [1] "2013-12-30"</code></pre>
<p>The issue appears to be that the R code is joining across a four day gap, which it shouldn’t do. So I assume that the threshold is different between the languages. This is curious as the seasonal and threshold climatologies correlate nearly perfectly. Diving deeper, let’s pull out the clim values around the time of this event and see what we see.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1">pctile_<span class="dv">80</span>_r_clim &lt;-<span class="st"> </span>pctile_<span class="dv">80</span>_r<span class="op">$</span>climatology</a>
<a class="sourceLine" id="cb65-2" data-line-number="2">pctile_<span class="dv">80</span>_r_clim_sub &lt;-<span class="st"> </span>pctile_<span class="dv">80</span>_r_clim[<span class="dv">11670</span><span class="op">:</span><span class="dv">11720</span>, ]</a>
<a class="sourceLine" id="cb65-3" data-line-number="3">pctile_<span class="dv">80</span>_py_clim_sub &lt;-<span class="st"> </span>pctile_<span class="dv">80</span>_py_clim[<span class="dv">11670</span><span class="op">:</span><span class="dv">11720</span>, ]</a>
<a class="sourceLine" id="cb65-4" data-line-number="4"></a>
<a class="sourceLine" id="cb65-5" data-line-number="5">r_fig &lt;-<span class="st"> </span><span class="kw">ggplot</span>(pctile_<span class="dv">80</span>_r_clim_sub, <span class="kw">aes</span>(<span class="dt">x =</span> t, <span class="dt">y =</span> temp)) <span class="op">+</span></a>
<a class="sourceLine" id="cb65-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/geom_flame">geom_flame</a></span>(<span class="kw">aes</span>(<span class="dt">y2 =</span> thresh)) <span class="op">+</span></a>
<a class="sourceLine" id="cb65-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb65-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> thresh), <span class="dt">colour =</span> <span class="st">"Red"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb65-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> seas), <span class="dt">colour =</span> <span class="st">"grey20"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb65-10" data-line-number="10"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">"R code"</span>)</a>
<a class="sourceLine" id="cb65-11" data-line-number="11"></a>
<a class="sourceLine" id="cb65-12" data-line-number="12">py_fig &lt;-<span class="st"> </span><span class="kw">ggplot</span>(pctile_<span class="dv">80</span>_py_clim_sub, </a>
<a class="sourceLine" id="cb65-13" data-line-number="13">                 <span class="kw">aes</span>(<span class="dt">x =</span> pctile_<span class="dv">80</span>_r_clim_sub<span class="op">$</span>t, <span class="dt">y =</span> pctile_<span class="dv">80</span>_r_clim_sub<span class="op">$</span>temp)) <span class="op">+</span></a>
<a class="sourceLine" id="cb65-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/geom_flame">geom_flame</a></span>(<span class="kw">aes</span>(<span class="dt">y2 =</span> thresh)) <span class="op">+</span></a>
<a class="sourceLine" id="cb65-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb65-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> thresh), <span class="dt">colour =</span> <span class="st">"Red"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb65-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> seas), <span class="dt">colour =</span> <span class="st">"grey20"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb65-18" data-line-number="18"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">"Python code"</span>)</a>
<a class="sourceLine" id="cb65-19" data-line-number="19"></a>
<a class="sourceLine" id="cb65-20" data-line-number="20"><span class="kw"><a href="https://www.rdocumentation.org/packages/ggpubr/topics/ggarrange">ggarrange</a></span>(r_fig, py_fig, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">nrow =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="r_vs_python_arguments_files/figure-html/unnamed-chunk-6-1.png" width="384" style="display: block; margin: auto;"></p>
<p>As we may see in the figure above, the difference is not perceptible to the human eye. Looking very closely at the clim outputs manually one may see that in the R code, the threshold on <code>2013-12-29</code> is just below the temperature value due to a rounding difference from the Python code at the third decimal place.</p>
<p>Also above one may see that even though the values correlate nearly perfectly, the sum of the seasonal climatology value output by R are <code>1.98122</code> less than the Python output. Considering that there are 12053 values, the average difference is only <code>0.00016</code>, which is not terribly much at all. The issue appears to be in the calculation of the threshold climatology. This value is not consistently different based on the <code>pctile</code> value used. It varies quite a bit. With the sum difference at <code>pctile = 80</code> being <code>-13.86432</code>, the default of <code>pctile = 90</code> being <code>-6.563516</code>, <code>pctile = 95</code> being <code>-3.382435</code>, and <code>pctile = 99</code> being <code>28.37769</code>. This is strong evidence that the threshold values are being calculated using some different method that needs to be addressed. That being said, even at the largest difference of <code>28.37769</code>, that is still only an average difference per row of <code>0.002354409</code></p>
<p>Digging deeper still, let’s pull up the old <code>RmarineHeatWaves</code> code and run another comparison with that to see if this difference is due to newer changes in the development of the <code>heatwaveR</code> package.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1">ts &lt;-<span class="st"> </span>RmarineHeatWaves<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/RmarineHeatWaves/topics/make_whole">make_whole</a></span>(sst_WA)</a>
<a class="sourceLine" id="cb66-2" data-line-number="2">default_r_old &lt;-<span class="st"> </span>RmarineHeatWaves<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/RmarineHeatWaves/topics/detect">detect</a></span>(<span class="dt">data =</span> ts, <span class="dt">climatology_start =</span> <span class="st">"1982-01-01"</span>, <span class="dt">climatology_end =</span> <span class="st">"2014-12-31"</span>)</a>
<a class="sourceLine" id="cb66-3" data-line-number="3">default_r_old_event &lt;-<span class="st"> </span>default_r_old<span class="op">$</span>event</a>
<a class="sourceLine" id="cb66-4" data-line-number="4">default_r_old_clim &lt;-<span class="st"> </span>default_r_old<span class="op">$</span>clim</a>
<a class="sourceLine" id="cb66-5" data-line-number="5"></a>
<a class="sourceLine" id="cb66-6" data-line-number="6"><span class="co"># Compare default new and old R clims  and intensities</span></a>
<a class="sourceLine" id="cb66-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(default_r<span class="op">$</span>climatology<span class="op">$</span>seas, default_r_old_clim<span class="op">$</span>seas_clim_year)</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_r<span class="op">$</span>climatology<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_r_old_clim<span class="op">$</span>seas_clim_year)</a></code></pre></div>
<pre><code>## [1] -0.07260093</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(default_r<span class="op">$</span>climatology<span class="op">$</span>thresh, default_r_old_clim<span class="op">$</span>thresh_clim_year)</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_r<span class="op">$</span>climatology<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_r_old_clim<span class="op">$</span>thresh_clim_year)</a></code></pre></div>
<pre><code>## [1] -0.009868637</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_r<span class="op">$</span>event<span class="op">$</span>intensity_cumulative) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_py_event<span class="op">$</span>intensity_cumulative)</a></code></pre></div>
<pre><code>## [1] 0.1630294</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_r<span class="op">$</span>event<span class="op">$</span>intensity_max) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_py_event<span class="op">$</span>intensity_max)</a></code></pre></div>
<pre><code>## [1] 0.008673771</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="co"># Compare default new and old R clims</span></a>
<a class="sourceLine" id="cb78-2" data-line-number="2">default_event &lt;-<span class="st"> </span><span class="kw">compare_event</span>(default_r<span class="op">$</span>event, default_r_old_event)</a>
<a class="sourceLine" id="cb78-3" data-line-number="3">default_event</a></code></pre></div>
<pre><code>##     r                            var
## 1   1                       event_no
## 2   1                    index_start
## 3  NA                     index_peak
## 4  NA                      index_end
## 5   1                       duration
## 6  NA                 intensity_mean
## 7  NA                  intensity_max
## 8  NA                  intensity_var
## 9  NA           intensity_cumulative
## 10 NA       intensity_mean_relThresh
## 11 NA        intensity_max_relThresh
## 12 NA        intensity_var_relThresh
## 13 NA intensity_cumulative_relThresh
## 14 NA             intensity_mean_abs
## 15 NA              intensity_max_abs
## 16 NA              intensity_var_abs
## 17 NA       intensity_cumulative_abs
## 18  1                     rate_onset
## 19  1                   rate_decline</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1"><span class="co"># Compare Python and old R clims and intensities</span></a>
<a class="sourceLine" id="cb80-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(default_py_clim<span class="op">$</span>seas, default_r_old_clim<span class="op">$</span>seas_clim_year)</a></code></pre></div>
<pre><code>## [1] 0.9999999</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_py_clim<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_r_old_clim<span class="op">$</span>seas_clim_year)</a></code></pre></div>
<pre><code>## [1] 1.98122</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(default_py_clim<span class="op">$</span>thresh, default_r_old_clim<span class="op">$</span>thresh_clim_year)</a></code></pre></div>
<pre><code>## [1] 0.9999996</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_py_clim<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_r_old_clim<span class="op">$</span>thresh_clim_year)</a></code></pre></div>
<pre><code>## [1] 6.563516</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_py_event<span class="op">$</span>intensity_cumulative) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_r_old_event<span class="op">$</span>int_cum)</a></code></pre></div>
<pre><code>## [1] -0.157388</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_py_event<span class="op">$</span>intensity_max) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(default_r_old_event<span class="op">$</span>int_max)</a></code></pre></div>
<pre><code>## [1] -0.008520925</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" data-line-number="1"><span class="co"># Compare Python and old R clims</span></a>
<a class="sourceLine" id="cb92-2" data-line-number="2">default_event &lt;-<span class="st"> </span><span class="kw">compare_event</span>(default_r_old_event, default_py_event)</a>
<a class="sourceLine" id="cb92-3" data-line-number="3">default_event</a></code></pre></div>
<pre><code>##     r                 var
## 1   1         index_start
## 2  NA          index_stop
## 3  NA            event_no
## 4   1            duration
## 5  NA            int_mean
## 6  NA             int_max
## 7  NA             int_var
## 8  NA             int_cum
## 9  NA int_mean_rel_thresh
## 10 NA  int_max_rel_thresh
## 11 NA  int_var_rel_thresh
## 12 NA  int_cum_rel_thresh
## 13 NA        int_mean_abs
## 14 NA         int_max_abs
## 15 NA         int_var_abs
## 16 NA         int_cum_abs
## 17 NA       int_mean_norm
## 18 NA        int_max_norm
## 19  1          rate_onset
## 20  1        rate_decline</code></pre>
<p>The differences between the old and new R implementation are minute to the point of being almost imperceptible.</p>
</div>
<div id="smoothpercentilewidth-comparisons" class="section level2">
<h2 class="hasAnchor">
<a href="#smoothpercentilewidth-comparisons" class="anchor"></a><code>smoothPercentileWidth</code> comparisons</h2>
<p>Seeing now that the choice of the <code>pctile</code> threshold may create results different enough as to produce a different counts of events, we need to look closer at the different arguments. I have my suspicions that the smoothing of the threshold values may be the culprit here.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" data-line-number="1">spw_no_r &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/detect_event">detect_event</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/ts2clm">ts2clm</a></span>(<span class="dt">data =</span> sst_WA, <span class="dt">smoothPercentile =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb94-2" data-line-number="2">                                <span class="dt">climatologyPeriod =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1982-01-01"</span>, <span class="st">"2014-12-31"</span>)))</a>
<a class="sourceLine" id="cb94-3" data-line-number="3">spw_<span class="dv">11</span>_r &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/detect_event">detect_event</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/ts2clm">ts2clm</a></span>(<span class="dt">data =</span> sst_WA, <span class="dt">smoothPercentileWidth =</span> <span class="dv">11</span>,</a>
<a class="sourceLine" id="cb94-4" data-line-number="4">                                <span class="dt">climatologyPeriod =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1982-01-01"</span>, <span class="st">"2014-12-31"</span>)))</a>
<a class="sourceLine" id="cb94-5" data-line-number="5">spw_<span class="dv">51</span>_r &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/detect_event">detect_event</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/ts2clm">ts2clm</a></span>(<span class="dt">data =</span> sst_WA, <span class="dt">smoothPercentileWidth =</span> <span class="dv">51</span>,</a>
<a class="sourceLine" id="cb94-6" data-line-number="6">                                <span class="dt">climatologyPeriod =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1982-01-01"</span>, <span class="st">"2014-12-31"</span>)))</a></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb95-1" data-line-number="1"><span class="co"># smoothPercentileWidth = FALSE</span></a>
<a class="sourceLine" id="cb95-2" data-line-number="2">mhws, clim <span class="op">=</span> mhw.detect(t, sst, smoothPercentile <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb95-3" data-line-number="3">mhws_df <span class="op">=</span> pd.DataFrame.from_dict(mhws)</a>
<a class="sourceLine" id="cb95-4" data-line-number="4">mhws_df.to_csv(<span class="st">'data/mhws_py_spw_no.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb95-5" data-line-number="5">clim_df <span class="op">=</span> pd.DataFrame.from_dict(clim)</a>
<a class="sourceLine" id="cb95-6" data-line-number="6">clim_df.to_csv(<span class="st">'data/clim_py_spw_no.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb95-7" data-line-number="7"><span class="co"># smoothPercentileWidth = 11</span></a>
<a class="sourceLine" id="cb95-8" data-line-number="8">mhws, clim <span class="op">=</span> mhw.detect(t, sst, smoothPercentileWidth <span class="op">=</span> <span class="dv">11</span>)</a>
<a class="sourceLine" id="cb95-9" data-line-number="9">mhws_df <span class="op">=</span> pd.DataFrame.from_dict(mhws)</a>
<a class="sourceLine" id="cb95-10" data-line-number="10">mhws_df.to_csv(<span class="st">'data/mhws_py_spw_11.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb95-11" data-line-number="11">clim_df <span class="op">=</span> pd.DataFrame.from_dict(clim)</a>
<a class="sourceLine" id="cb95-12" data-line-number="12">clim_df.to_csv(<span class="st">'data/clim_py_spw_11.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb95-13" data-line-number="13"><span class="co"># smoothPercentileWidth = 51</span></a>
<a class="sourceLine" id="cb95-14" data-line-number="14">mhws, clim <span class="op">=</span> mhw.detect(t, sst, smoothPercentileWidth <span class="op">=</span> <span class="dv">51</span>)</a>
<a class="sourceLine" id="cb95-15" data-line-number="15">mhws_df <span class="op">=</span> pd.DataFrame.from_dict(mhws)</a>
<a class="sourceLine" id="cb95-16" data-line-number="16">mhws_df.to_csv(<span class="st">'data/mhws_py_spw_51.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb95-17" data-line-number="17">clim_df <span class="op">=</span> pd.DataFrame.from_dict(clim)</a>
<a class="sourceLine" id="cb95-18" data-line-number="18">clim_df.to_csv(<span class="st">'data/clim_py_spw_51.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1"><span class="co"># Load Python</span></a>
<a class="sourceLine" id="cb96-2" data-line-number="2">spw_no_py_event &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/mhws_py_spw_no.csv"</span>)</a>
<a class="sourceLine" id="cb96-3" data-line-number="3">spw_no_py_clim &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/clim_py_spw_no.csv"</span>)</a>
<a class="sourceLine" id="cb96-4" data-line-number="4">spw_<span class="dv">11</span>_py_event &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/mhws_py_spw_11.csv"</span>)</a>
<a class="sourceLine" id="cb96-5" data-line-number="5">spw_<span class="dv">11</span>_py_clim &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/clim_py_spw_11.csv"</span>)</a>
<a class="sourceLine" id="cb96-6" data-line-number="6">spw_<span class="dv">51</span>_py_event &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/mhws_py_spw_51.csv"</span>)</a>
<a class="sourceLine" id="cb96-7" data-line-number="7">spw_<span class="dv">51</span>_py_clim &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/clim_py_spw_51.csv"</span>)</a>
<a class="sourceLine" id="cb96-8" data-line-number="8"></a>
<a class="sourceLine" id="cb96-9" data-line-number="9"><span class="co"># Compare clims and intensities</span></a>
<a class="sourceLine" id="cb96-10" data-line-number="10"><span class="co"># no smoothing</span></a>
<a class="sourceLine" id="cb96-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(spw_no_r<span class="op">$</span>climatology<span class="op">$</span>seas, spw_no_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] 0.9999992</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_r<span class="op">$</span>climatology<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] -2.124743</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(spw_no_r<span class="op">$</span>climatology<span class="op">$</span>thresh, spw_no_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] 0.9999965</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_r<span class="op">$</span>climatology<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] -6.492852</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_r<span class="op">$</span>event<span class="op">$</span>intensity_cumulative) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_py_event<span class="op">$</span>intensity_cumulative)</a></code></pre></div>
<pre><code>## [1] 0.1128817</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_r<span class="op">$</span>event<span class="op">$</span>intensity_max) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_py_event<span class="op">$</span>intensity_max)</a></code></pre></div>
<pre><code>## [1] 0.01567827</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" data-line-number="1"><span class="co"># 11 days</span></a>
<a class="sourceLine" id="cb108-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(spw_<span class="dv">11</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas, spw_<span class="dv">11</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] 0.9999997</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_<span class="dv">11</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_<span class="dv">11</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] -2.053809</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(spw_<span class="dv">11</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh, spw_<span class="dv">11</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] 0.999999</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_<span class="dv">11</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_<span class="dv">11</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] -6.294534</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_<span class="dv">11</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_cumulative) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_<span class="dv">11</span>_py_event<span class="op">$</span>intensity_cumulative)</a></code></pre></div>
<pre><code>## [1] 0.1236748</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_<span class="dv">11</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_max) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_<span class="dv">11</span>_py_event<span class="op">$</span>intensity_max)</a></code></pre></div>
<pre><code>## [1] 0.006339516</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" data-line-number="1"><span class="co"># 51 days</span></a>
<a class="sourceLine" id="cb120-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(spw_<span class="dv">51</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas, spw_<span class="dv">51</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] 0.9999999</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb122-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_<span class="dv">51</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_<span class="dv">51</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] -2.049584</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(spw_<span class="dv">51</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh, spw_<span class="dv">51</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] 0.9999998</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_<span class="dv">51</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_<span class="dv">51</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] -6.601041</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_<span class="dv">51</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_cumulative) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_<span class="dv">51</span>_py_event<span class="op">$</span>intensity_cumulative)</a></code></pre></div>
<pre><code>## [1] 0.1554402</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_<span class="dv">51</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_max) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_<span class="dv">51</span>_py_event<span class="op">$</span>intensity_max)</a></code></pre></div>
<pre><code>## [1] 0.006590975</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" data-line-number="1"><span class="co"># Compare events</span></a>
<a class="sourceLine" id="cb132-2" data-line-number="2">spw_no_event &lt;-<span class="st"> </span><span class="kw">compare_event</span>(spw_no_r<span class="op">$</span>event, spw_no_py_event)</a>
<a class="sourceLine" id="cb132-3" data-line-number="3">spw_no_event</a></code></pre></div>
<pre><code>##            r                            var
## 1         NA                       event_no
## 2  1.0000000                    index_start
## 3  1.0000000                     index_peak
## 4  1.0000000                      index_end
## 5  1.0000000                       duration
## 6  0.9999980                 intensity_mean
## 7  0.9999991                  intensity_max
## 8  0.9993833                  intensity_var
## 9  0.9999999           intensity_cumulative
## 10 0.9999956       intensity_mean_relThresh
## 11 0.9997743        intensity_max_relThresh
## 12 0.9993307        intensity_var_relThresh
## 13 0.9999995 intensity_cumulative_relThresh
## 14 1.0000000             intensity_mean_abs
## 15 0.9989767              intensity_max_abs
## 16 0.9995815              intensity_var_abs
## 17 1.0000000       intensity_cumulative_abs
## 18 0.9999991                     rate_onset
## 19 0.9999993                   rate_decline</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" data-line-number="1">spw_<span class="dv">11</span>_event &lt;-<span class="st"> </span><span class="kw">compare_event</span>(spw_<span class="dv">11</span>_r<span class="op">$</span>event, spw_<span class="dv">11</span>_py_event)</a>
<a class="sourceLine" id="cb134-2" data-line-number="2">spw_<span class="dv">11</span>_event</a></code></pre></div>
<pre><code>##            r                            var
## 1         NA                       event_no
## 2  1.0000000                    index_start
## 3  1.0000000                     index_peak
## 4  1.0000000                      index_end
## 5  1.0000000                       duration
## 6  0.9999983                 intensity_mean
## 7  0.9999994                  intensity_max
## 8  0.9994320                  intensity_var
## 9  0.9999999           intensity_cumulative
## 10 0.9999963       intensity_mean_relThresh
## 11 0.9999581        intensity_max_relThresh
## 12 0.9994217        intensity_var_relThresh
## 13 0.9999996 intensity_cumulative_relThresh
## 14 1.0000000             intensity_mean_abs
## 15 0.9989804              intensity_max_abs
## 16 0.9996098              intensity_var_abs
## 17 1.0000000       intensity_cumulative_abs
## 18 0.9999985                     rate_onset
## 19 0.9999995                   rate_decline</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" data-line-number="1">spw_<span class="dv">51</span>_event &lt;-<span class="st"> </span><span class="kw">compare_event</span>(spw_<span class="dv">51</span>_r<span class="op">$</span>event, spw_<span class="dv">51</span>_py_event)</a>
<a class="sourceLine" id="cb136-2" data-line-number="2">spw_<span class="dv">51</span>_event</a></code></pre></div>
<pre><code>##            r                            var
## 1         NA                       event_no
## 2  1.0000000                    index_start
## 3  1.0000000                     index_peak
## 4  1.0000000                      index_end
## 5  1.0000000                       duration
## 6  0.9999995                 intensity_mean
## 7  0.9999999                  intensity_max
## 8  0.9996564                  intensity_var
## 9  1.0000000           intensity_cumulative
## 10 0.9999968       intensity_mean_relThresh
## 11 0.9999679        intensity_max_relThresh
## 12 0.9996309        intensity_var_relThresh
## 13 0.9999996 intensity_cumulative_relThresh
## 14 1.0000000             intensity_mean_abs
## 15 0.9992145              intensity_max_abs
## 16 0.9997404              intensity_var_abs
## 17 1.0000000       intensity_cumulative_abs
## 18 1.0000000                     rate_onset
## 19 1.0000000                   rate_decline</code></pre>
<p>Surprisingly the smoothing window, regardless if it is applied or not, seems to make little difference. But again, let’s compare the old R code against Python as well.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" data-line-number="1">ts &lt;-<span class="st"> </span>RmarineHeatWaves<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/RmarineHeatWaves/topics/make_whole">make_whole</a></span>(sst_WA)</a>
<a class="sourceLine" id="cb138-2" data-line-number="2">spw_no_r_old &lt;-<span class="st"> </span>RmarineHeatWaves<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/RmarineHeatWaves/topics/detect">detect</a></span>(<span class="dt">data =</span> ts, <span class="dt">climatology_start =</span> <span class="st">"1982-01-01"</span>, <span class="dt">climatology_end =</span> <span class="st">"2014-12-31"</span>, <span class="dt">smooth_percentile =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb138-3" data-line-number="3">spw_no_r_old_event &lt;-<span class="st"> </span>spw_no_r_old<span class="op">$</span>event</a>
<a class="sourceLine" id="cb138-4" data-line-number="4">spw_no_r_old_clim &lt;-<span class="st"> </span>spw_no_r_old<span class="op">$</span>clim</a>
<a class="sourceLine" id="cb138-5" data-line-number="5"></a>
<a class="sourceLine" id="cb138-6" data-line-number="6"><span class="co"># Compare new and old R code</span></a>
<a class="sourceLine" id="cb138-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_r<span class="op">$</span>climatology<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_r_old_clim<span class="op">$</span>seas_clim_year)</a></code></pre></div>
<pre><code>## [1] -0.06278893</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_r<span class="op">$</span>climatology<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_r_old_clim<span class="op">$</span>thresh_clim_year)</a></code></pre></div>
<pre><code>## [1] 0.006147504</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" data-line-number="1"><span class="co"># Compare old &amp; new R against Python</span></a>
<a class="sourceLine" id="cb142-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_py_clim<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_r_old_clim<span class="op">$</span>seas_clim_year)</a></code></pre></div>
<pre><code>## [1] 2.061954</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_py_clim<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_r<span class="op">$</span>climatology<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] 2.124743</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_py_clim<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_r_old_clim<span class="op">$</span>thresh_clim_year)</a></code></pre></div>
<pre><code>## [1] 6.499</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_py_clim<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(spw_no_r<span class="op">$</span>climatology<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] 6.492852</code></pre>
<p>Again, almost no difference.</p>
</div>
<div id="windowhalfwidth-comparisons" class="section level2">
<h2 class="hasAnchor">
<a href="#windowhalfwidth-comparisons" class="anchor"></a><code>windowHalfWidth</code> comparisons</h2>
<p>We’ve now seen that the differences between both the new &amp; old R code and the Python code hold consistently different regardless of the changing of the <code>pctile</code> or <code>smoothWindowPercentile</code>. This then leads me to think that this is just a rounding issue between the two languages, and that there is not some fundamentally different calculation happening somewhere in the code. That being said, it is still necessary to be thorough and so I’ll go through the rest of the arguments now. Starting with <code>windowHalfWidth</code>.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" data-line-number="1">whw_<span class="dv">3</span>_r &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/detect_event">detect_event</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/ts2clm">ts2clm</a></span>(<span class="dt">data =</span> sst_WA, <span class="dt">windowHalfWidth =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb150-2" data-line-number="2">                               <span class="dt">climatologyPeriod =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1982-01-01"</span>, <span class="st">"2014-12-31"</span>)))</a>
<a class="sourceLine" id="cb150-3" data-line-number="3">whw_<span class="dv">7</span>_r &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/detect_event">detect_event</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/ts2clm">ts2clm</a></span>(<span class="dt">data =</span> sst_WA, <span class="dt">windowHalfWidth =</span> <span class="dv">7</span>,</a>
<a class="sourceLine" id="cb150-4" data-line-number="4">                               <span class="dt">climatologyPeriod =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1982-01-01"</span>, <span class="st">"2014-12-31"</span>)))</a></code></pre></div>
<div class="sourceCode" id="cb151"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb151-1" data-line-number="1"><span class="co"># windowHalfWidth = 3</span></a>
<a class="sourceLine" id="cb151-2" data-line-number="2">mhws, clim <span class="op">=</span> mhw.detect(t, sst, windowHalfWidth <span class="op">=</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb151-3" data-line-number="3">mhws_df <span class="op">=</span> pd.DataFrame.from_dict(mhws)</a>
<a class="sourceLine" id="cb151-4" data-line-number="4">mhws_df.to_csv(<span class="st">'data/mhws_py_whw_3.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb151-5" data-line-number="5">clim_df <span class="op">=</span> pd.DataFrame.from_dict(clim)</a>
<a class="sourceLine" id="cb151-6" data-line-number="6">clim_df.to_csv(<span class="st">'data/clim_py_whw_3.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb151-7" data-line-number="7"><span class="co"># windowHalfWidth = 7</span></a>
<a class="sourceLine" id="cb151-8" data-line-number="8">mhws, clim <span class="op">=</span> mhw.detect(t, sst, windowHalfWidth <span class="op">=</span> <span class="dv">7</span>)</a>
<a class="sourceLine" id="cb151-9" data-line-number="9">mhws_df <span class="op">=</span> pd.DataFrame.from_dict(mhws)</a>
<a class="sourceLine" id="cb151-10" data-line-number="10">mhws_df.to_csv(<span class="st">'data/mhws_py_whw_7.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb151-11" data-line-number="11">clim_df <span class="op">=</span> pd.DataFrame.from_dict(clim)</a>
<a class="sourceLine" id="cb151-12" data-line-number="12">clim_df.to_csv(<span class="st">'data/clim_py_whw_7.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a></code></pre></div>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" data-line-number="1"><span class="co"># Load Python</span></a>
<a class="sourceLine" id="cb152-2" data-line-number="2">whw_<span class="dv">3</span>_py_event &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/mhws_py_whw_3.csv"</span>)</a>
<a class="sourceLine" id="cb152-3" data-line-number="3">whw_<span class="dv">3</span>_py_clim &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/clim_py_whw_3.csv"</span>)</a>
<a class="sourceLine" id="cb152-4" data-line-number="4">whw_<span class="dv">7</span>_py_event &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/mhws_py_whw_7.csv"</span>)</a>
<a class="sourceLine" id="cb152-5" data-line-number="5">whw_<span class="dv">7</span>_py_clim &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/clim_py_whw_7.csv"</span>)</a>
<a class="sourceLine" id="cb152-6" data-line-number="6"></a>
<a class="sourceLine" id="cb152-7" data-line-number="7"><span class="co"># Compare clims and intensities</span></a>
<a class="sourceLine" id="cb152-8" data-line-number="8"><span class="co"># 3 days</span></a>
<a class="sourceLine" id="cb152-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(whw_<span class="dv">3</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas, whw_<span class="dv">3</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] 0.9999999</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">3</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">3</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] -1.284023</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(whw_<span class="dv">3</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh, whw_<span class="dv">3</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] 0.9999999</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">3</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">3</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] -3.022406</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">3</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_cumulative) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">3</span>_py_event<span class="op">$</span>intensity_cumulative)</a></code></pre></div>
<pre><code>## [1] 0.103755</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">3</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_max) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">3</span>_py_event<span class="op">$</span>intensity_max)</a></code></pre></div>
<pre><code>## [1] 0.005514523</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" data-line-number="1"><span class="co"># 7 days</span></a>
<a class="sourceLine" id="cb164-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(whw_<span class="dv">7</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas, whw_<span class="dv">7</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] 0.9999998</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">7</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">7</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] -2.859033</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(whw_<span class="dv">7</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh, whw_<span class="dv">7</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] 0.999998</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb170-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">7</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">7</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] -13.58322</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">7</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_cumulative) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">7</span>_py_event<span class="op">$</span>intensity_cumulative)</a></code></pre></div>
<pre><code>## [1] 8.303694</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">7</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_max) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">7</span>_py_event<span class="op">$</span>intensity_max)</a></code></pre></div>
<pre><code>## [1] 1.901248</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" data-line-number="1"><span class="co"># Compare events</span></a>
<a class="sourceLine" id="cb176-2" data-line-number="2">whw_<span class="dv">3</span>_event &lt;-<span class="st"> </span><span class="kw">compare_event</span>(whw_<span class="dv">3</span>_r<span class="op">$</span>event, whw_<span class="dv">3</span>_py_event)</a>
<a class="sourceLine" id="cb176-3" data-line-number="3">whw_<span class="dv">3</span>_event</a></code></pre></div>
<pre><code>##            r                            var
## 1         NA                       event_no
## 2  1.0000000                    index_start
## 3  1.0000000                     index_peak
## 4  1.0000000                      index_end
## 5  1.0000000                       duration
## 6  0.9999997                 intensity_mean
## 7  0.9999999                  intensity_max
## 8  0.9996480                  intensity_var
## 9  1.0000000           intensity_cumulative
## 10 0.9999993       intensity_mean_relThresh
## 11 0.9999938        intensity_max_relThresh
## 12 0.9996042        intensity_var_relThresh
## 13 0.9999999 intensity_cumulative_relThresh
## 14 1.0000000             intensity_mean_abs
## 15 0.9993263              intensity_max_abs
## 16 0.9997486              intensity_var_abs
## 17 1.0000000       intensity_cumulative_abs
## 18 1.0000000                     rate_onset
## 19 1.0000000                   rate_decline</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" data-line-number="1"><span class="co"># whw_7_event &lt;- compare_event(whw_7_r$event, whw_7_py_event)</span></a>
<a class="sourceLine" id="cb178-2" data-line-number="2"><span class="co"># whw_7_event</span></a></code></pre></div>
<p>We see here that the <code>windowHalfWidth</code> has a large effect on the difference between the results than anything else so far. The difference per row is still low at ~0.001 so isn’t much cause for alarm. We do however detect a different number of events if <code>windowHalfWidth = 7</code>. Let’s see how they differ.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" data-line-number="1">whw_<span class="dv">7</span>_r_event &lt;-<span class="st"> </span>whw_<span class="dv">7</span>_r<span class="op">$</span>event</a>
<a class="sourceLine" id="cb179-2" data-line-number="2">whw_<span class="dv">7</span>_r_event<span class="op">$</span>date_start[<span class="op">!</span>whw_<span class="dv">7</span>_r_event<span class="op">$</span>date_start <span class="op">%in%</span><span class="st"> </span>whw_<span class="dv">7</span>_py_event<span class="op">$</span>date_start]</a></code></pre></div>
<pre><code>## [1] "2006-03-05"</code></pre>
<p>The difference lies in the R code detecting a five day event that the Python code must have seen as only 4 days or less. Again due to very narrow differences in the threshold values.</p>
<p>Let’s look if there is a difference between the old and new R code.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" data-line-number="1">ts &lt;-<span class="st"> </span>RmarineHeatWaves<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/RmarineHeatWaves/topics/make_whole">make_whole</a></span>(sst_WA)</a>
<a class="sourceLine" id="cb181-2" data-line-number="2">whw_<span class="dv">7</span>_r_old &lt;-<span class="st"> </span>RmarineHeatWaves<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/RmarineHeatWaves/topics/detect">detect</a></span>(<span class="dt">data =</span> ts, <span class="dt">climatology_start =</span> <span class="st">"1982-01-01"</span>, <span class="dt">climatology_end =</span> <span class="st">"2014-12-31"</span>, <span class="dt">window_half_width =</span> <span class="dv">7</span>)</a>
<a class="sourceLine" id="cb181-3" data-line-number="3"></a>
<a class="sourceLine" id="cb181-4" data-line-number="4"><span class="co"># Compare new and old R code</span></a>
<a class="sourceLine" id="cb181-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">7</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">7</span>_r_old<span class="op">$</span>clim<span class="op">$</span>seas_clim_year)</a></code></pre></div>
<pre><code>## [1] -0.06257652</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">7</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">7</span>_r_old<span class="op">$</span>clim<span class="op">$</span>thresh_clim_year)</a></code></pre></div>
<pre><code>## [1] 0.003332891</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">7</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_cumulative) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">7</span>_r_old<span class="op">$</span>event<span class="op">$</span>int_cum)</a></code></pre></div>
<pre><code>## [1] 0.004781785</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">7</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_max) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(whw_<span class="dv">7</span>_r_old<span class="op">$</span>event<span class="op">$</span>int_max)</a></code></pre></div>
<pre><code>## [1] 0.0001258996</code></pre>
<p>Everything matches up between old and new R for <code>windowHalfWidth = 7</code>.</p>
</div>
<div id="minduration-comparisons" class="section level2">
<h2 class="hasAnchor">
<a href="#minduration-comparisons" class="anchor"></a><code>minDuration</code> comparisons</h2>
<p>Now we move away form the arguments that effect the climatology calculations, and focus just on those that determine the classification of events.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" data-line-number="1">minD_<span class="dv">3</span>_r &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/detect_event">detect_event</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/ts2clm">ts2clm</a></span>(<span class="dt">data =</span> sst_WA, <span class="dt">climatologyPeriod =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1982-01-01"</span>, <span class="st">"2014-12-31"</span>)), </a>
<a class="sourceLine" id="cb189-2" data-line-number="2">                         <span class="dt">minDuration =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb189-3" data-line-number="3">minD_<span class="dv">7</span>_r &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/detect_event">detect_event</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/ts2clm">ts2clm</a></span>(<span class="dt">data =</span> sst_WA, <span class="dt">climatologyPeriod =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1982-01-01"</span>, <span class="st">"2014-12-31"</span>)), </a>
<a class="sourceLine" id="cb189-4" data-line-number="4">                         <span class="dt">minDuration =</span> <span class="dv">7</span>)</a></code></pre></div>
<div class="sourceCode" id="cb190"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb190-1" data-line-number="1"><span class="co"># minDuration = 3</span></a>
<a class="sourceLine" id="cb190-2" data-line-number="2">mhws, clim <span class="op">=</span> mhw.detect(t, sst, minDuration <span class="op">=</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb190-3" data-line-number="3">mhws_df <span class="op">=</span> pd.DataFrame.from_dict(mhws)</a>
<a class="sourceLine" id="cb190-4" data-line-number="4">mhws_df.to_csv(<span class="st">'data/mhws_py_minD_3.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb190-5" data-line-number="5">clim_df <span class="op">=</span> pd.DataFrame.from_dict(clim)</a>
<a class="sourceLine" id="cb190-6" data-line-number="6">clim_df.to_csv(<span class="st">'data/clim_py_minD_3.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb190-7" data-line-number="7"><span class="co"># minDuration = 7</span></a>
<a class="sourceLine" id="cb190-8" data-line-number="8">mhws, clim <span class="op">=</span> mhw.detect(t, sst, minDuration <span class="op">=</span> <span class="dv">7</span>)</a>
<a class="sourceLine" id="cb190-9" data-line-number="9">mhws_df <span class="op">=</span> pd.DataFrame.from_dict(mhws)</a>
<a class="sourceLine" id="cb190-10" data-line-number="10">mhws_df.to_csv(<span class="st">'data/mhws_py_minD_7.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb190-11" data-line-number="11">clim_df <span class="op">=</span> pd.DataFrame.from_dict(clim)</a>
<a class="sourceLine" id="cb190-12" data-line-number="12">clim_df.to_csv(<span class="st">'data/clim_py_minD_7.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a></code></pre></div>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" data-line-number="1"><span class="co"># Load Python</span></a>
<a class="sourceLine" id="cb191-2" data-line-number="2">minD_<span class="dv">3</span>_py_event &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/mhws_py_minD_3.csv"</span>)</a>
<a class="sourceLine" id="cb191-3" data-line-number="3">minD_<span class="dv">3</span>_py_clim &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/clim_py_minD_3.csv"</span>)</a>
<a class="sourceLine" id="cb191-4" data-line-number="4">minD_<span class="dv">7</span>_py_event &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/mhws_py_minD_7.csv"</span>)</a>
<a class="sourceLine" id="cb191-5" data-line-number="5">minD_<span class="dv">7</span>_py_clim &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/clim_py_minD_7.csv"</span>)</a>
<a class="sourceLine" id="cb191-6" data-line-number="6"></a>
<a class="sourceLine" id="cb191-7" data-line-number="7"><span class="co"># Compare clims and intensities</span></a>
<a class="sourceLine" id="cb191-8" data-line-number="8"><span class="co"># 3 days</span></a>
<a class="sourceLine" id="cb191-9" data-line-number="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(minD_<span class="dv">3</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas, minD_<span class="dv">3</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] 0.9999999</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(minD_<span class="dv">3</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(minD_<span class="dv">3</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] -2.053821</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(minD_<span class="dv">3</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh, minD_<span class="dv">3</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] 0.9999996</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(minD_<span class="dv">3</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(minD_<span class="dv">3</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] -6.573385</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(minD_<span class="dv">3</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_cumulative) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(minD_<span class="dv">3</span>_py_event<span class="op">$</span>intensity_cumulative)</a></code></pre></div>
<pre><code>## [1] 0.1969908</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(minD_<span class="dv">3</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_max) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(minD_<span class="dv">3</span>_py_event<span class="op">$</span>intensity_max)</a></code></pre></div>
<pre><code>## [1] 0.01369288</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" data-line-number="1"><span class="co"># 7 days</span></a>
<a class="sourceLine" id="cb203-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(minD_<span class="dv">7</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas, minD_<span class="dv">7</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] 0.9999999</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(minD_<span class="dv">7</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(minD_<span class="dv">7</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] -2.053821</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(minD_<span class="dv">7</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh, minD_<span class="dv">7</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] 0.9999996</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(minD_<span class="dv">7</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(minD_<span class="dv">7</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] -6.573385</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(minD_<span class="dv">7</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_cumulative) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(minD_<span class="dv">7</span>_py_event<span class="op">$</span>intensity_cumulative)</a></code></pre></div>
<pre><code>## [1] 0.1169319</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(minD_<span class="dv">7</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_max) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(minD_<span class="dv">7</span>_py_event<span class="op">$</span>intensity_max)</a></code></pre></div>
<pre><code>## [1] 0.007283979</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" data-line-number="1"><span class="co"># Compare events</span></a>
<a class="sourceLine" id="cb215-2" data-line-number="2">minD_<span class="dv">3</span>_event &lt;-<span class="st"> </span><span class="kw">compare_event</span>(minD_<span class="dv">3</span>_r<span class="op">$</span>event, minD_<span class="dv">3</span>_py_event)</a>
<a class="sourceLine" id="cb215-3" data-line-number="3">minD_<span class="dv">3</span>_event</a></code></pre></div>
<pre><code>##            r                            var
## 1         NA                       event_no
## 2  1.0000000                    index_start
## 3  1.0000000                     index_peak
## 4  1.0000000                      index_end
## 5  1.0000000                       duration
## 6  0.9999988                 intensity_mean
## 7  0.9999997                  intensity_max
## 8  0.9987979                  intensity_var
## 9  1.0000000           intensity_cumulative
## 10 0.9999895       intensity_mean_relThresh
## 11 0.9999946        intensity_max_relThresh
## 12 0.9987109        intensity_var_relThresh
## 13 0.9999996 intensity_cumulative_relThresh
## 14 1.0000000             intensity_mean_abs
## 15 0.9991713              intensity_max_abs
## 16 0.9990268              intensity_var_abs
## 17 1.0000000       intensity_cumulative_abs
## 18 1.0000000                     rate_onset
## 19 0.9999999                   rate_decline</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" data-line-number="1">minD_<span class="dv">7</span>_event &lt;-<span class="st"> </span><span class="kw">compare_event</span>(minD_<span class="dv">7</span>_r<span class="op">$</span>event, minD_<span class="dv">7</span>_py_event)</a>
<a class="sourceLine" id="cb217-2" data-line-number="2">minD_<span class="dv">7</span>_event</a></code></pre></div>
<pre><code>##            r                            var
## 1         NA                       event_no
## 2  1.0000000                    index_start
## 3  1.0000000                     index_peak
## 4  1.0000000                      index_end
## 5  1.0000000                       duration
## 6  0.9999992                 intensity_mean
## 7  0.9999997                  intensity_max
## 8  0.9992868                  intensity_var
## 9  1.0000000           intensity_cumulative
## 10 0.9999965       intensity_mean_relThresh
## 11 0.9999768        intensity_max_relThresh
## 12 0.9992416        intensity_var_relThresh
## 13 0.9999995 intensity_cumulative_relThresh
## 14 1.0000000             intensity_mean_abs
## 15 0.9996425              intensity_max_abs
## 16 0.9994579              intensity_var_abs
## 17 1.0000000       intensity_cumulative_abs
## 18 0.9999999                     rate_onset
## 19 0.9999999                   rate_decline</code></pre>
<p>As expected, changing the minimum duration of events has no effect on the threshold calculations. It is however gratifying to see that the same number of events is calculated between languages, regardless of the minimum duration. The difference these cause in the intensities of the events is also negligible between languages.</p>
</div>
<div id="joinacrossgaps-comparisons" class="section level2">
<h2 class="hasAnchor">
<a href="#joinacrossgaps-comparisons" class="anchor"></a><code>joinAcrossGaps</code> comparisons</h2>
<p>Now for the final argument in the base functionality. This too should not effect the climatologies. Only the events.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" data-line-number="1">joinAG_no_r &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/detect_event">detect_event</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/ts2clm">ts2clm</a></span>(<span class="dt">data =</span> sst_WA, <span class="dt">climatologyPeriod =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1982-01-01"</span>, <span class="st">"2014-12-31"</span>)), </a>
<a class="sourceLine" id="cb219-2" data-line-number="2">                            <span class="dt">joinAcrossGaps =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb219-3" data-line-number="3">joinAG_<span class="dv">1</span>_r &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/detect_event">detect_event</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/ts2clm">ts2clm</a></span>(<span class="dt">data =</span> sst_WA, <span class="dt">climatologyPeriod =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1982-01-01"</span>, <span class="st">"2014-12-31"</span>)), </a>
<a class="sourceLine" id="cb219-4" data-line-number="4">                           <span class="dt">maxGap =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb219-5" data-line-number="5">joinAG_<span class="dv">5</span>_r &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/detect_event">detect_event</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/heatwaveR/topics/ts2clm">ts2clm</a></span>(<span class="dt">data =</span> sst_WA, <span class="dt">climatologyPeriod =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"1982-01-01"</span>, <span class="st">"2014-12-31"</span>)), </a>
<a class="sourceLine" id="cb219-6" data-line-number="6">                           <span class="dt">maxGap =</span> <span class="dv">5</span>)</a></code></pre></div>
<div class="sourceCode" id="cb220"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb220-1" data-line-number="1"><span class="co"># joinAGuration = False</span></a>
<a class="sourceLine" id="cb220-2" data-line-number="2">mhws, clim <span class="op">=</span> mhw.detect(t, sst, joinAcrossGaps <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb220-3" data-line-number="3">mhws_df <span class="op">=</span> pd.DataFrame.from_dict(mhws)</a>
<a class="sourceLine" id="cb220-4" data-line-number="4">mhws_df.to_csv(<span class="st">'data/mhws_py_joinAG_no.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb220-5" data-line-number="5">clim_df <span class="op">=</span> pd.DataFrame.from_dict(clim)</a>
<a class="sourceLine" id="cb220-6" data-line-number="6">clim_df.to_csv(<span class="st">'data/clim_py_joinAG_no.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb220-7" data-line-number="7"><span class="co"># maxGap = 1</span></a>
<a class="sourceLine" id="cb220-8" data-line-number="8">mhws, clim <span class="op">=</span> mhw.detect(t, sst, maxGap <span class="op">=</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb220-9" data-line-number="9">mhws_df <span class="op">=</span> pd.DataFrame.from_dict(mhws)</a>
<a class="sourceLine" id="cb220-10" data-line-number="10">mhws_df.to_csv(<span class="st">'data/mhws_py_joinAG_1.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb220-11" data-line-number="11">clim_df <span class="op">=</span> pd.DataFrame.from_dict(clim)</a>
<a class="sourceLine" id="cb220-12" data-line-number="12">clim_df.to_csv(<span class="st">'data/clim_py_joinAG_1.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb220-13" data-line-number="13"><span class="co"># maxGap = 5</span></a>
<a class="sourceLine" id="cb220-14" data-line-number="14">mhws, clim <span class="op">=</span> mhw.detect(t, sst, maxGap <span class="op">=</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb220-15" data-line-number="15">mhws_df <span class="op">=</span> pd.DataFrame.from_dict(mhws)</a>
<a class="sourceLine" id="cb220-16" data-line-number="16">mhws_df.to_csv(<span class="st">'data/mhws_py_joinAG_5.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a>
<a class="sourceLine" id="cb220-17" data-line-number="17">clim_df <span class="op">=</span> pd.DataFrame.from_dict(clim)</a>
<a class="sourceLine" id="cb220-18" data-line-number="18">clim_df.to_csv(<span class="st">'data/clim_py_joinAG_5.csv'</span>, sep <span class="op">=</span> <span class="st">','</span>, index <span class="op">=</span> <span class="va">False</span>)</a></code></pre></div>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" data-line-number="1"><span class="co"># Load Python</span></a>
<a class="sourceLine" id="cb221-2" data-line-number="2">joinAG_no_py_event &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/mhws_py_joinAG_no.csv"</span>)</a>
<a class="sourceLine" id="cb221-3" data-line-number="3">joinAG_no_py_clim &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/clim_py_joinAG_no.csv"</span>)</a>
<a class="sourceLine" id="cb221-4" data-line-number="4">joinAG_<span class="dv">1</span>_py_event &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/mhws_py_joinAG_1.csv"</span>)</a>
<a class="sourceLine" id="cb221-5" data-line-number="5">joinAG_<span class="dv">1</span>_py_clim &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/clim_py_joinAG_1.csv"</span>)</a>
<a class="sourceLine" id="cb221-6" data-line-number="6">joinAG_<span class="dv">5</span>_py_event &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/mhws_py_joinAG_5.csv"</span>)</a>
<a class="sourceLine" id="cb221-7" data-line-number="7">joinAG_<span class="dv">5</span>_py_clim &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">"data/clim_py_joinAG_5.csv"</span>)</a>
<a class="sourceLine" id="cb221-8" data-line-number="8"></a>
<a class="sourceLine" id="cb221-9" data-line-number="9"><span class="co"># Compare clims and intensities</span></a>
<a class="sourceLine" id="cb221-10" data-line-number="10"><span class="co"># no days</span></a>
<a class="sourceLine" id="cb221-11" data-line-number="11"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(joinAG_no_r<span class="op">$</span>climatology<span class="op">$</span>seas, joinAG_no_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] 0.9999999</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_no_r<span class="op">$</span>climatology<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_no_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] -2.053821</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(joinAG_no_r<span class="op">$</span>climatology<span class="op">$</span>thresh, joinAG_no_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] 0.9999996</code></pre>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb227-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_no_r<span class="op">$</span>climatology<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_no_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] -6.573385</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb229-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_no_r<span class="op">$</span>event<span class="op">$</span>intensity_cumulative) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_no_py_event<span class="op">$</span>intensity_cumulative)</a></code></pre></div>
<pre><code>## [1] 0.1559537</code></pre>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb231-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_no_r<span class="op">$</span>event<span class="op">$</span>intensity_max) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_no_py_event<span class="op">$</span>intensity_max)</a></code></pre></div>
<pre><code>## [1] 0.01446085</code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb233-1" data-line-number="1"><span class="co"># 1 day</span></a>
<a class="sourceLine" id="cb233-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(joinAG_<span class="dv">1</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas, joinAG_<span class="dv">1</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] 0.9999999</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb235-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_<span class="dv">1</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_<span class="dv">1</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] -2.053821</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb237-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(joinAG_<span class="dv">1</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh, joinAG_<span class="dv">1</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] 0.9999996</code></pre>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb239-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_<span class="dv">1</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_<span class="dv">1</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] -6.573385</code></pre>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb241-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_<span class="dv">1</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_cumulative) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_<span class="dv">1</span>_py_event<span class="op">$</span>intensity_cumulative)</a></code></pre></div>
<pre><code>## [1] 0.1584107</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb243-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_<span class="dv">1</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_max) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_<span class="dv">1</span>_py_event<span class="op">$</span>intensity_max)</a></code></pre></div>
<pre><code>## [1] 0.01211662</code></pre>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb245-1" data-line-number="1"><span class="co"># 7 days</span></a>
<a class="sourceLine" id="cb245-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(joinAG_<span class="dv">5</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas, joinAG_<span class="dv">5</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] 0.9999999</code></pre>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb247-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_<span class="dv">5</span>_r<span class="op">$</span>climatology<span class="op">$</span>seas) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_<span class="dv">5</span>_py_clim<span class="op">$</span>seas)</a></code></pre></div>
<pre><code>## [1] -2.053821</code></pre>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb249-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/cor">cor</a></span>(joinAG_<span class="dv">5</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh, joinAG_<span class="dv">5</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] 0.9999996</code></pre>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb251-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_<span class="dv">5</span>_r<span class="op">$</span>climatology<span class="op">$</span>thresh) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_<span class="dv">5</span>_py_clim<span class="op">$</span>thresh)</a></code></pre></div>
<pre><code>## [1] -6.573385</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb253-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_<span class="dv">5</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_cumulative) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_<span class="dv">5</span>_py_event<span class="op">$</span>intensity_cumulative)</a></code></pre></div>
<pre><code>## [1] 0.1610846</code></pre>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb255-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_<span class="dv">5</span>_r<span class="op">$</span>event<span class="op">$</span>intensity_max) <span class="op">-</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(joinAG_<span class="dv">5</span>_py_event<span class="op">$</span>intensity_max)</a></code></pre></div>
<pre><code>## [1] 0.008638111</code></pre>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb257-1" data-line-number="1"><span class="co"># Compare events</span></a>
<a class="sourceLine" id="cb257-2" data-line-number="2">joinAG_no_event &lt;-<span class="st"> </span><span class="kw">compare_event</span>(joinAG_no_r<span class="op">$</span>event, joinAG_no_py_event)</a>
<a class="sourceLine" id="cb257-3" data-line-number="3">joinAG_no_event</a></code></pre></div>
<pre><code>##            r                            var
## 1         NA                       event_no
## 2  1.0000000                    index_start
## 3  1.0000000                     index_peak
## 4  1.0000000                      index_end
## 5  1.0000000                       duration
## 6  0.9999989                 intensity_mean
## 7  0.9999996                  intensity_max
## 8  0.9989905                  intensity_var
## 9  1.0000000           intensity_cumulative
## 10 0.9999973       intensity_mean_relThresh
## 11 0.9999993        intensity_max_relThresh
## 12 0.9989440        intensity_var_relThresh
## 13 0.9999996 intensity_cumulative_relThresh
## 14 1.0000000             intensity_mean_abs
## 15 0.9997855              intensity_max_abs
## 16 0.9992315              intensity_var_abs
## 17 1.0000000       intensity_cumulative_abs
## 18 0.9999999                     rate_onset
## 19 0.9999999                   rate_decline</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb259-1" data-line-number="1">joinAG_<span class="dv">1</span>_event &lt;-<span class="st"> </span><span class="kw">compare_event</span>(joinAG_<span class="dv">1</span>_r<span class="op">$</span>event, joinAG_<span class="dv">1</span>_py_event)</a>
<a class="sourceLine" id="cb259-2" data-line-number="2">joinAG_<span class="dv">1</span>_event</a></code></pre></div>
<pre><code>##            r                            var
## 1         NA                       event_no
## 2  1.0000000                    index_start
## 3  1.0000000                     index_peak
## 4  1.0000000                      index_end
## 5  1.0000000                       duration
## 6  0.9999991                 intensity_mean
## 7  0.9999997                  intensity_max
## 8  0.9992930                  intensity_var
## 9  1.0000000           intensity_cumulative
## 10 0.9999971       intensity_mean_relThresh
## 11 0.9999832        intensity_max_relThresh
## 12 0.9992473        intensity_var_relThresh
## 13 0.9999996 intensity_cumulative_relThresh
## 14 1.0000000             intensity_mean_abs
## 15 0.9997788              intensity_max_abs
## 16 0.9995174              intensity_var_abs
## 17 1.0000000       intensity_cumulative_abs
## 18 0.9999999                     rate_onset
## 19 0.9999999                   rate_decline</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb261-1" data-line-number="1">joinAG_<span class="dv">5</span>_event &lt;-<span class="st"> </span><span class="kw">compare_event</span>(joinAG_<span class="dv">5</span>_r<span class="op">$</span>event, joinAG_<span class="dv">5</span>_py_event)</a>
<a class="sourceLine" id="cb261-2" data-line-number="2">joinAG_<span class="dv">5</span>_event</a></code></pre></div>
<pre><code>##            r                            var
## 1         NA                       event_no
## 2  1.0000000                    index_start
## 3  1.0000000                     index_peak
## 4  1.0000000                      index_end
## 5  1.0000000                       duration
## 6  0.9999990                 intensity_mean
## 7  0.9999997                  intensity_max
## 8  0.9995542                  intensity_var
## 9  1.0000000           intensity_cumulative
## 10 0.9999960       intensity_mean_relThresh
## 11 0.9999993        intensity_max_relThresh
## 12 0.9995227        intensity_var_relThresh
## 13 0.9999995 intensity_cumulative_relThresh
## 14 1.0000000             intensity_mean_abs
## 15 0.9966753              intensity_max_abs
## 16 0.9997826              intensity_var_abs
## 17 1.0000000       intensity_cumulative_abs
## 18 0.9999999                     rate_onset
## 19 0.9999999                   rate_decline</code></pre>
<p>A little surprising, but good to see, is that the length of gap between events does not cause a different number of events to be calculated between languages considering all other arguments are kept at the default.</p>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p>It appears as though, down to a very small degree, there are differences between the outputs of the two languages. That being said, these differences appear to be due to the rounding differences that exist between the languages and so it is not a fault of the code in either, nor are there fundamentally different processes being employed to make the calculations. Indeed, though minute differences may be found in the calculations of the seasonal and threshold climatologies, these differences are consistent. They do not vary. They may change in magnitude depending on the arguments supplied, but these differences never become larger than ~0.001 per row, which has been deemed here as acceptable. Interestingly, though not surprising in hindsight, is that the changing of the <code>windowHalfWidth</code> argument causes the largest difference between the languages. This makes sense because this argument determines how many values are meaned together in the beginning of the climatology calculations. And as the differences are due to rounding, that numerical fingerprint is boldest here.</p>
<p>Depending on how some of the arguments were tweaked, the two languages very rarely would detect one event more or less than the other. This was due to the odd day being just above or below the threshold by ~0.001 degrees or so. Very rare, but so is existence, hypothetically.</p>
<p>Ultimately, I am very confident in saying that the outputs of these two languages are comparable.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#overview">Overview</a></li>
      <li><a href="#pctile-comparisons"><code>pctile</code> comparisons</a></li>
      <li><a href="#smoothpercentilewidth-comparisons"><code>smoothPercentileWidth</code> comparisons</a></li>
      <li><a href="#windowhalfwidth-comparisons"><code>windowHalfWidth</code> comparisons</a></li>
      <li><a href="#minduration-comparisons"><code>minDuration</code> comparisons</a></li>
      <li><a href="#joinacrossgaps-comparisons"><code>joinAcrossGaps</code> comparisons</a></li>
      <li><a href="#conclusion">Conclusion</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Robert W. Schlegel, Eric C. J. Oliver, Alistair J. Hobday, Albertus J. Smit.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
